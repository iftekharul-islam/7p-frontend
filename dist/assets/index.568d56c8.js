import{a as ge,r as R,ds as _e,dt as fe,du as je,dv as le,dw as ve,j as e,f as c,Q as w,S as de,V as M,X as j,Y as o,a0 as ye,G as C,L as P,I as ie,dx as be,dy as me,dz as he}from"./index.5c94aa8f.js";/* empty css                  */import{a as Ne}from"./App.98c84a7f.js";/* empty css                                  */import{h as B}from"./moment.4d75c86c.js";import{S as A}from"./react-select.esm.a71beee1.js";import"./emotion-memoize.esm.06f0e458.js";const $e=()=>{var q,E,I,W,Q,U,G,K,H,J,V,X,Z,ee,re,ne,se,ae;const p=Ne(),n=ge(a=>a.rejects),[Y,k]=R.exports.useState(!1),d=n==null?void 0:n.searchParams;R.exports.useEffect(()=>{p(_e()),p(fe()),p(je())},[]),R.exports.useEffect(()=>{p(le()),p(ve())},[d]);const T=async()=>{k(!0),await p(le()),k(!1)},ue=async()=>{var l,t,h,u;k(!0);let a="Are you sure you want to move all "+((t=Object.keys((l=n==null?void 0:n.data)==null?void 0:l.batch_array))==null?void 0:t.length)+" batches shown to the first station?";confirm(a)==!0&&await p(be(Object.keys((u=(h=n==null?void 0:n.data)==null?void 0:h.batch_array)!=null?u:{}))),k(!1)},F=async a=>{await p(me({id:a}))},v=a=>{p(he(a))},pe=async(a,l)=>{a.preventDefault(),await p(he({graphic_status:l==null?void 0:l.graphic_status,reason:l==null?void 0:l.rejection_reason})),T()},z=(a,l=`
`,t=0)=>{let h="",u="";t===1&&(h='<strong style="font-size: 110%;">',u="</strong>");let _="";const i=JSON.parse(a);if(i)for(const f in i){let g=i[f];f!=="Confirmation_of_Order_Details"&&f!=="couponcode"&&(typeof g=="string"&&(g==null?void 0:g.includes("$"))&&t===1&&(g=`<span style="font-size: 120%;">${g}</span>`),_+=`${f.replaceAll("_"," ")} = ${h}${g}${u}${l}`)}return _};return e("div",{className:"app-user-list",children:c(R.exports.Fragment,{children:[c(w,{className:"px-1",children:[e(de,{children:e("h4",{className:"card-title",children:"Process Rejects"})}),e(M,{children:c(j,{children:[e(o,{sm:"2",children:e(ye,{placeholder:"Batch Number",value:d==null?void 0:d.batch_number,onChange:a=>{var l;v({batch_number:(l=a==null?void 0:a.target)==null?void 0:l.value})}})}),e(o,{sm:"2",children:e(A,{className:"react-select",classNamePrefix:"select",options:n==null?void 0:n.sectionOptions,placeholder:"Select a Department",value:(q=n==null?void 0:n.sectionOptions)==null?void 0:q.find(a=>(a==null?void 0:a.value)==(d==null?void 0:d.section)),onChange:a=>v({section:a==null?void 0:a.value}),isClearable:!0})}),e(o,{sm:"2",children:e(A,{className:"react-select",classNamePrefix:"select",options:n==null?void 0:n.graphic_statusOptions,placeholder:"Select Status",value:(E=n==null?void 0:n.graphic_statusOptions)==null?void 0:E.find(a=>(a==null?void 0:a.value)==(d==null?void 0:d.graphic_status)),onChange:a=>v({graphic_status:a==null?void 0:a.value}),isClearable:!0})}),e(o,{sm:"3",children:e(A,{className:"react-select",classNamePrefix:"select",options:n==null?void 0:n.reasonOptions,placeholder:"Select a reason",value:(I=n==null?void 0:n.reasonOptions)==null?void 0:I.find(a=>(a==null?void 0:a.value)==(d==null?void 0:d.reason)),onChange:a=>v({reason:a==null?void 0:a.value}),isClearable:!0})}),e(o,{sm:"1",className:"d-flex align-items-start flex-column",children:e(C,{color:"primary",onClick:T,disabled:Y,children:Y?"Please Wait":"Filter"})}),e(o,{sm:"2",className:"d-flex align-items-start flex-column",children:e(C,{color:"primary",onClick:ue,disabled:Y,children:Y?"Please Wait":"Send All to First Station"})})]})})]}),((Q=(W=n==null?void 0:n.data)==null?void 0:W.summary)==null?void 0:Q.length)>0?e("span",{children:e(w,{children:c(M,{children:[c(j,{className:"mb-1",children:[e(o,{sm:"6",children:"Type"}),e(o,{sm:"5",children:"Reason"}),e(o,{sm:"1",children:"Count"})]}),(G=(U=n==null?void 0:n.data)==null?void 0:U.summary)==null?void 0:G.map((a,l)=>{var t,h,u,_;return c(j,{className:"mb-1",children:[e(o,{sm:"6",children:(h=(t=n==null?void 0:n.graphic_statusOptions)==null?void 0:t.find(i=>(i==null?void 0:i.value)==(a==null?void 0:a.graphic_status)))==null?void 0:h.label}),e(o,{sm:"5",children:(_=(u=n==null?void 0:n.reasonOptions)==null?void 0:u.find(i=>(i==null?void 0:i.value)==(a==null?void 0:a.rejection_reason)))==null?void 0:_.label}),e(o,{sm:"1",children:e(P,{onClick:i=>pe(i,a),children:a==null?void 0:a.count})})]},l)}),c(j,{className:"mb-1",children:[e(o,{sm:"8"}),e(o,{sm:"3",children:"Total"}),e(o,{sm:"1",children:(H=(K=n==null?void 0:n.data)==null?void 0:K.summary)==null?void 0:H.reduce((a,l)=>a+(l.count||0),0)})]})]})})}):((X=Object.keys((V=(J=n==null?void 0:n.data)==null?void 0:J.batch_array)!=null?V:{}))==null?void 0:X.length)>0?c(w,{children:[e(de,{children:c("h4",{children:[(Z=n==null?void 0:n.data)==null?void 0:Z.total_items," found in"," ",(ne=Object.keys((re=(ee=n==null?void 0:n.data)==null?void 0:ee.batch_array)!=null?re:{}))==null?void 0:ne.length," Batch/es"]})}),e(M,{children:(ae=Object.keys((se=n==null?void 0:n.data)==null?void 0:se.batch_array))==null?void 0:ae.map((a,l)=>{var h,u,_,i,f,g,ce,te;const t=(h=n==null?void 0:n.data)==null?void 0:h.batch_array[a];return e("span",{children:c(j,{className:"mb-1 border rounded",children:[c(o,{sm:"2",children:[e("strong",{className:"m-1",children:e(P,{to:`/batch-list/${a}`,children:a})}),c("div",{children:[e(A,{className:"react-select m-1",classNamePrefix:"select",placeholder:"Send Batch to",options:n==null?void 0:n.destinationOptions,value:(u=n==null?void 0:n.destinationOptions)==null?void 0:u.find(r=>(r==null?void 0:r.value)==(d==null?void 0:d.station_change)),onChange:r=>v({station_change:r==null?void 0:r.value})}),c(C,{color:"primary",className:"m-1",onClick:r=>{r.preventDefault()},children:["Update Batch ",a]})]})]}),c(o,{sm:"10",children:[typeof(t==null?void 0:t.items)=="array"&&((_=t==null?void 0:t.items)==null?void 0:_.length)>0&&((i=t==null?void 0:t.items)==null?void 0:i.map((r,L)=>{var s,y,b,m,N,x,S,O;return c(j,{className:"border rounded",children:[c(o,{sm:"2",children:[e("div",{children:e(P,{to:`/customer-order-edit/${(s=r==null?void 0:r.order)==null?void 0:s.id}`,children:(y=r==null?void 0:r.order)==null?void 0:y.short_order})}),e("div",{children:B((b=r==null?void 0:r.order)==null?void 0:b.order_date).format("DD MMM YYYY")}),c("div",{children:["Item: ",r==null?void 0:r.id]}),(r==null?void 0:r.item_quantity)>1&&c("strong",{style:{fontSize:"125%"},children:["QTY: ",r.item_quantity]}),e("br",{}),((m=r==null?void 0:r.rejections)==null?void 0:m.length)>1&&c(ie,{children:[e("br",{}),c("strong",{style:{color:"red"},children:["Rejected ",(N=r==null?void 0:r.rejections)==null?void 0:N.length," Times"]}),e("br",{})]}),(r==null?void 0:r.rejection)&&e(C,{color:"primary",className:"m-1",onClick:D=>{var $;D.preventDefault(),F(($=r==null?void 0:r.rejection)==null?void 0:$.id)},children:"Reprint Label"}),((x=t==null?void 0:t.items)==null?void 0:x.length)>1&&e("a",{href:`/rejections/split?item_id=${r.id}&batch_number=${r.batch_number}`,className:"btn btn-xs",children:"New Batch"})]}),e(o,{sm:"2",children:e("a",{href:r==null?void 0:r.item_url,target:"_blank",children:e("img",{src:r==null?void 0:r.item_thumb,height:90,width:90})})}),e(o,{sm:"4",children:c("div",{children:[e("div",{children:r.item_description}),c("p",{children:["SKU: ",r.child_sku]}),r.rejection?c("div",{children:[c("strong",{children:[r.rejection.graphic_status,":"]}),r.rejection.rejection_reason_info&&e("span",{children:r.rejection.rejection_reason_info.rejection_message}),((O=(S=r==null?void 0:r.rejection)==null?void 0:S.rejection_message)==null?void 0:O.length)>0&&c("div",{children:[e("strong",{children:"Note:"})," ",r.rejection.rejection_message]}),c("div",{children:[e("strong",{children:"Rejected:"})," ",B(r.rejection.created_at).format("DD MMM YYYY"),r.rejection.from_station&&c("span",{children:[" ","from"," ",r.rejection.from_station.station_name]}),r.rejection.user&&c("span",{children:[" ","by ",r.rejection.user.username]})]}),r.rejection.supervisor_message&&c("div",{children:[e("strong",{children:"Supervisor:"})," ",r.rejection.supervisor_message,e("br",{})]}),e("input",{type:"text",name:`supervisor_message[${r.rejection.id}]`,className:"supervisor_message form-control",style:{minWidth:"200px"},placeholder:"Enter a message"})]}):e("p",{children:"- Reject information not found -"})]})}),e(o,{sm:"4",children:z(r==null?void 0:r.item_option)})]},L)})),typeof(t==null?void 0:t.items)=="object"&&((g=Object.keys((f=t==null?void 0:t.items)!=null?f:{}))==null?void 0:g.length)>0&&((te=Object.keys((ce=t==null?void 0:t.items)!=null?ce:{}))==null?void 0:te.map((r,L)=>{var y,b,m,N,x,S,O,D;const s=t==null?void 0:t.items[r];return c(j,{className:"border rounded",children:[c(o,{sm:"2",children:[e("div",{children:e(P,{to:`/customer-order-edit/${(y=s==null?void 0:s.order)==null?void 0:y.id}`,children:(b=s==null?void 0:s.order)==null?void 0:b.short_order})}),e("div",{children:B((m=s==null?void 0:s.order)==null?void 0:m.order_date).format("DD MMM YYYY")}),c("div",{children:["Item: ",s==null?void 0:s.id]}),(s==null?void 0:s.item_quantity)>1&&c("strong",{style:{fontSize:"125%"},children:["QTY: ",s.item_quantity]}),e("br",{}),((N=s==null?void 0:s.rejections)==null?void 0:N.length)>1&&c(ie,{children:[e("br",{}),c("strong",{style:{color:"red"},children:["Rejected ",(x=s==null?void 0:s.rejections)==null?void 0:x.length," ","Times"]}),e("br",{})]}),(s==null?void 0:s.rejection)&&e(C,{color:"primary",className:"m-1",onClick:$=>{var oe;$.preventDefault(),F((oe=s==null?void 0:s.rejection)==null?void 0:oe.id)},children:"Reprint Label"}),((S=t==null?void 0:t.items)==null?void 0:S.length)>1&&e("a",{href:`/rejections/split?item_id=${s.id}&batch_number=${s.batch_number}`,className:"btn btn-xs",children:"New Batch"})]}),e(o,{sm:"2",children:e("a",{href:s==null?void 0:s.item_url,target:"_blank",children:e("img",{src:s==null?void 0:s.item_thumb,height:200,width:150})})}),e(o,{sm:"4",children:c("div",{children:[e("div",{children:s.item_description}),c("p",{children:["SKU: ",s.child_sku]}),s.rejection?c("div",{children:[c("strong",{children:[s.rejection.graphic_status,":"]}),s.rejection.rejection_reason_info&&e("span",{children:s.rejection.rejection_reason_info.rejection_message}),((D=(O=s==null?void 0:s.rejection)==null?void 0:O.rejection_message)==null?void 0:D.length)>0&&c("div",{children:[e("strong",{children:"Note:"})," ",s.rejection.rejection_message]}),c("div",{children:[e("strong",{children:"Rejected:"})," ",B(s.rejection.created_at).format("DD MMM YYYY"),s.rejection.from_station&&c("span",{children:[" ","from"," ",s.rejection.from_station.station_name]}),s.rejection.user&&c("span",{children:[" ","by ",s.rejection.user.username]})]}),s.rejection.supervisor_message&&c("div",{children:[e("strong",{children:"Supervisor:"})," ",s.rejection.supervisor_message,e("br",{})]}),e("input",{type:"text",name:`supervisor_message[${s.rejection.id}]`,className:"supervisor_message form-control",style:{minWidth:"200px"},placeholder:"Enter a message"})]}):e("p",{children:"- Reject information not found -"})]})}),e(o,{sm:"4",children:z(s==null?void 0:s.item_option)})]},L)}))]})]})})})})]}):e(w,{children:e(M,{children:e("h4",{className:"d-flex align-items-center justify-content-center",children:"No Rejects Found"})})})]})})};export{$e as default};
