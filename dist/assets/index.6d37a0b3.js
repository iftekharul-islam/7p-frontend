import{k as en,a as j,r as F,f as r,X as g,j as l,Y as s,L as w,a0 as m,G as u,Z as H,cy as ln,a5 as rn,cz as B,cA as sn,cB as dn,cC as on,Q as P,S as Z,V as J,bn as z,cD as tn,cE as cn}from"./index.5fc3947b.js";/* empty css                  */import{a as q}from"./App.685d754b.js";import{h as nn}from"./moment.4d75c86c.js";import{F as K}from"./index.120995ed.js";import{S as D}from"./react-select.esm.d750bbbc.js";import"./emotion-memoize.esm.06f0e458.js";const an=(v,p)=>{var S,O;const x=q();en();const{data:i,printerOptions:N,searchParams:_}=j(n=>n.printSublimations);F.exports.useEffect(()=>{if(_!=null&&_.set_printer){const n=t==null?void 0:t.map(c=>({...c,printer:_==null?void 0:_.set_printer}));k(n)}},[_==null?void 0:_.set_printer]);const[t,k]=F.exports.useState([]);F.exports.useEffect(()=>{var n,c;((n=i==null?void 0:i.batches)==null?void 0:n.length)>0&&k((c=i==null?void 0:i.batches)==null?void 0:c.map(o=>({batch_number:o==null?void 0:o.batch_number})))},[i==null?void 0:i.batches]);const C=(n,c,o)=>{const M=t==null?void 0:t.find(h=>(h==null?void 0:h.batch_number)==n),$=t==null?void 0:t.filter(h=>(h==null?void 0:h.batch_number)!=n);k([...$,{...M,[c]:o}])},y=async n=>{C(n,"loader",!0);const c=t==null?void 0:t.find(o=>(o==null?void 0:o.batch_number)==n);if(c){const o=await x(ln(c));o!=null&&o.payload&&window.open(o==null?void 0:o.payload,"_blank")}else alert("Please select Printer");C(n,"loader",!1)};return r("span",{children:[r(g,{children:[r("h5",{children:[(S=i==null?void 0:i.batches)==null?void 0:S.length," batches found"]}),l("hr",{})]}),(O=i==null?void 0:i.batches)==null?void 0:O.map((n,c)=>{var o,M,$,h,R,A,U,I,L,Q;return l("span",{children:r(g,{className:(n==null?void 0:n.to_printer_date)!=null&&"bg-info",children:[r(s,{sm:"3",children:[l(w,{to:`/batch-list/${n==null?void 0:n.batch_number}`,children:r("strong",{children:[n==null?void 0:n.batch_number,"-"]})}),((o=n==null?void 0:n.items)==null?void 0:o.length)>1&&r("span",{children:[(M=n==null?void 0:n.items)==null?void 0:M.length," Items-"]}),(n==null?void 0:n.store_id)&&l("strong",{className:"text-danger",children:(R=(h=($=i==null?void 0:i.stores)==null?void 0:$.find(e=>(e==null?void 0:e.value)==(n==null?void 0:n.store_id)))==null?void 0:h.label)!=null?R:null}),l("div",{children:n.route.csv_extension.toLowerCase().includes("soft")?r("div",{className:"button-box print-group",children:[r(s,{lg:"3",children:[l(m,{type:"hidden",name:"batch_number",value:n.batch_number}),l(m,{type:"hidden",name:"printer",value:"SOFT-1"}),l(u,{id:`move_${n.batch_number}`,className:"btn btn-xs btn-primary",onClick:()=>y(n.batch_number),children:"SOFT-1"})]}),r(s,{lg:"3",children:[l(m,{type:"hidden",name:"batch_number",value:n.batch_number}),l(m,{type:"hidden",name:"printer",value:"SOFT-2"}),l(u,{id:`move_${n.batch_number}`,className:"btn btn-xs btn-info",onClick:()=>y(n.batch_number),children:"SOFT-2"})]}),l(s,{lg:"3",children:r(H,{id:`move_form_${n.batch_number}${Math.floor(Math.random()*90)+10}`,children:[l(m,{type:"hidden",name:"batch_number",value:n.batch_number}),l(m,{type:"hidden",name:"printer",value:"SOFT-3"}),l(u,{id:`move_${n.batch_number}`,className:"btn btn-xs btn-primary",onClick:()=>y(n.batch_number),children:"SOFT-3"})]})}),l(s,{lg:"3",children:r(H,{id:`move_form_${n.batch_number}${Math.floor(Math.random()*90)+10}`,children:[l(m,{type:"hidden",name:"batch_number",value:n.batch_number}),l(m,{type:"hidden",name:"printer",value:"EPSON-5"}),l(u,{id:`move_${n.batch_number}`,className:"btn btn-xs btn-warning",onClick:()=>y(n.batch_number),children:"EPSON-5"})]})})]}):n.route.csv_extension.toLowerCase().includes("hard")?r("div",{className:"button-box print-group",children:[l(s,{lg:"4",children:r(H,{id:`move_form_${n.batch_number}${Math.floor(Math.random()*90)+10}`,children:[l(m,{type:"hidden",name:"batch_number",value:n.batch_number}),l(m,{type:"hidden",name:"printer",value:"HARD-1"}),l(u,{id:`move_${n.batch_number}`,className:"btn btn-xs btn-danger",onClick:()=>y(n.batch_number),children:"Send to HARD-1"})]})}),l(s,{lg:"4",children:r(H,{id:`move_form_${n.batch_number}${Math.floor(Math.random()*90)+10}`,children:[l(m,{type:"hidden",name:"batch_number",value:n.batch_number}),l(m,{type:"hidden",name:"printer",value:"HARD-2"}),l(u,{id:`move_${n.batch_number}`,className:"btn btn-xs btn-success",onClick:()=>y(n.batch_number),children:"Send to HARD-2"})]})}),l(s,{lg:"4",children:r(H,{id:`move_form_${n.batch_number}${Math.floor(Math.random()*90)+10}`,children:[l(m,{type:"hidden",name:"batch_number",value:n.batch_number}),l(m,{type:"hidden",name:"printer",value:"HARD-3"}),l(u,{id:`move_${n.batch_number}`,className:"btn btn-xs btn-danger",onClick:()=>y(n.batch_number),children:"Send to HARD-3"})]})})]}):l("div",{className:"print-group",children:r(s,{xs:"12",children:[l(D,{className:"react-select",classNamePrefix:"select",options:N,value:N==null?void 0:N.find(e=>{var d;return(e==null?void 0:e.value)==((d=t==null?void 0:t.find(f=>(f==null?void 0:f.batch_number)==(n==null?void 0:n.batch_number)))==null?void 0:d.printer)}),onChange:e=>{C(n==null?void 0:n.batch_number,"printer",e==null?void 0:e.value)},placeholder:"Select Printer"}),l(u,{color:"primary",onClick:()=>y(n.batch_number),children:(A=t==null?void 0:t.find(e=>(e==null?void 0:e.batch_number)==(n==null?void 0:n.batch_number)))!=null&&A.loader?"Loading":"Send"})]})})})]}),l(s,{sm:"1",children:l("a",{href:`/batch-list/${n==null?void 0:n.batch_number}`,children:l("img",{src:(U=n==null?void 0:n.items[0])==null?void 0:U.item_thumb,alt:"print",width:"50px",height:"50px"})})}),r(s,{sm:"3",children:[(n==null?void 0:n.type)==="P"&&l("div",{children:l("strong",{style:{color:"red"},children:"IN PRODUCTION:"})}),(n==null?void 0:n.type)==="Q"&&l("div",{children:l("strong",{style:{color:"red"},children:"IN QC:"})}),n!=null&&n.production_station?r("div",{children:["Give to: ",(I=n==null?void 0:n.production_station)==null?void 0:I.station_description]}):r("div",{children:["PRODUCTION STATION NOT FOUND: ",n==null?void 0:n.production_station_id]}),(n==null?void 0:n.status)!=="active"&&r("div",{children:["Batch Status:"," ",l("strong",{style:{color:"red"},children:n==null?void 0:n.status})]}),l("br",{}),"First Order Date:"," ",nn(n==null?void 0:n.min_order_date).format("DD-MM-YYYY")]}),r(s,{sm:"1",children:["Graphic",l("br",{}),"QTY: ",(L=n==null?void 0:n.items[0])==null?void 0:L.item_quantity]}),l(s,{sm:"1",children:((n==null?void 0:n.graphic_found)=="Found"||(n==null?void 0:n.graphic_found)=="Unknown")&&l("a",{href:"batches/view_graphic?batch_number=%s",target:"_blank",children:"View Graphics"})}),r(s,{sm:"2",children:[r("div",{className:"d-flex align-items-center",children:[l("span",{children:"Scale: "}),l(m,{onChange:e=>{var d;return C(n==null?void 0:n.batch_number,"scale",(d=e==null?void 0:e.target)==null?void 0:d.value)}}),"%"]}),r("div",{children:["pdf"," ",l(m,{type:"checkbox",onChange:e=>{var d;return C(n==null?void 0:n.batch_number,"pdf",(d=e==null?void 0:e.target)==null?void 0:d.checked)}})]})]}),r(s,{sm:"1",children:[l("div",{children:"Rejects"}),(Q=n==null?void 0:n.items)==null?void 0:Q.map((e,d)=>{var f;e!=null&&e.rejections&&((f=e==null?void 0:e.rejections)==null||f.map((a,G)=>{var Y,b;return r(g,{children:[l(s,{sm:"3"}),r(s,{sm:"9",children:["Item ",e==null?void 0:e.id," Rejected ",a==null?void 0:a.created_at,"by ",(Y=a==null?void 0:a.user)==null?void 0:Y.username,(a==null?void 0:a.rejection_reason_info)&&"-"+((b=a==null?void 0:a.rejection_reason_info)==null?void 0:b.rejection_message),"- ",a==null?void 0:a.rejection_message]})]},G)}))})]}),l("hr",{})]},c)})})]})},mn=()=>{var R,A,U,I,L,Q;const v=q(),{data:p,queues:x,searchParams:i,printerOptions:N,typeOption:_,stationsOptions:t,storeOptions:k}=j(e=>e.printSublimations),[C,y]=rn(),S=C.get("select_batch"),[O,n]=F.exports.useState(!1),c=e=>{v(B(e))};F.exports.useEffect(async()=>{o(),await v(B({select_batch:S}))},[S]);const o=async()=>{n(!0),await v(sn({select_batch:S!=null?S:null})),n(!1)},M=async()=>{await v(tn())},$=()=>{v(cn())},h=async e=>{await v(B({production_station_id:[e]})),o()};return F.exports.useEffect(()=>{o(),v(dn()),v(on()),M()},[]),r(P,{children:[l(Z,{children:l("h4",{children:"Send Graphics to Printer"})}),r(J,{children:[r(g,{className:"mb-1",children:[l(s,{md:"7"}),l(s,{md:"3",children:l(D,{className:"react-select",classNamePrefix:"select",options:N,value:N.find(e=>e.value===(i==null?void 0:i.printer)),onChange:e=>{c({printer:e==null?void 0:e.value})}})}),l(s,{md:"2",children:l(u,{color:"primary",onClick:$,children:"Print All"})})]}),r(P,{className:"border rounded",children:[r(g,{className:"m-1",children:[l(s,{md:"1",children:l(m,{type:"text",placeholder:"Batch Number",value:i==null?void 0:i.select_batch,onChange:e=>{c({...i,select_batch:e.target.value})}})}),l(s,{md:"1",children:l(D,{className:"react-select",classNamePrefix:"select",placeholder:"Type",options:_,value:_.find(e=>e.value===(i==null?void 0:i.type)),onChange:e=>{c({type:e==null?void 0:e.value})}})}),l(s,{md:"3",children:l(D,{className:"react-select",classNamePrefix:"select",placeholder:"Select Section",isMulti:!0,options:t,value:t.filter(e=>{var d;return(d=i==null?void 0:i.production_station_id)==null?void 0:d.includes(e.value)}),onChange:e=>{c({...i,production_station_id:e==null?void 0:e.map(d=>d.value)})}})}),l(s,{md:"3",children:l(D,{className:"react-select",classNamePrefix:"select",placeholder:"Select Store",isMulti:!0,options:k,value:k.filter(e=>{var d;return(d=i==null?void 0:i.store_id)==null?void 0:d.includes(e.value)}),onChange:e=>{c({...i,store_id:e==null?void 0:e.map(d=>d.value)})}})}),l(s,{md:"2",children:l(K,{className:"form-control",placeholder:"From",value:(R=i==null?void 0:i.from_date)!=null?R:null,options:{dateFormat:"d-m-Y"},onChange:e=>c({from_date:e[0]})})}),l(s,{md:"2",children:l(K,{className:"form-control",placeholder:"To",value:(A=i==null?void 0:i.to_date)!=null?A:null,options:{dateFormat:"d-m-Y"},onChange:e=>c({to_date:e[0]})})})]}),r(g,{className:"m-1 mt-0",children:[l(s,{md:"10",children:l(D,{className:"react-select",classNamePrefix:"select",placeholder:"Mass set a printer",options:N,value:N.find(e=>e.value===(i==null?void 0:i.set_printer)),onChange:e=>{c({set_printer:e==null?void 0:e.value})}})}),l(s,{md:"2",children:l(u,{color:"primary",onClick:o,disabled:O,children:O?r("span",{className:"d-flex justify-content-center",children:[l(z,{size:"sm"}),"Wait..."]}):"Show"})})]})]}),l(P,{children:O?r("span",{className:"d-flex justify-content-center align-items-center",children:[l("span",{className:"mx-1",children:l(z,{size:"sm"})}),"Data Loading..."]}):r(g,{children:[l(s,{md:"10",children:((U=p==null?void 0:p.batches)==null?void 0:U.length)>0?l(an,{loading:O,setLoading:n}):((I=p==null?void 0:p.summary)==null?void 0:I.length)>0?r("span",{children:[r(g,{children:[l(s,{md:"6",className:"d-flex justify-content-start",children:l("b",{children:"Production Station"})}),l(s,{md:"3",className:"d-flex justify-content-center",children:l("b",{children:"First order"})}),l(s,{md:"3",className:"d-flex justify-content-end",children:l("b",{children:"Batches"})})]}),(L=p==null?void 0:p.summary)==null?void 0:L.map((e,d)=>{var f;return r("span",{children:[l("hr",{}),r(g,{children:[l(s,{md:"6",className:"d-flex justify-content-start",children:(f=e==null?void 0:e.production_station)==null?void 0:f.station_description}),l(s,{md:"3",className:"d-flex justify-content-center",children:nn(e==null?void 0:e.date).format("YYYY-MM-DD")}),l(s,{md:"3",className:"d-flex justify-content-end",children:l(w,{onClick:a=>{a.preventDefault(),h(e==null?void 0:e.production_station_id)},children:e==null?void 0:e.count})})]})]},d)}),l("hr",{}),r(g,{children:[l(s,{md:"6"}),l(s,{md:"3",className:"d-flex justify-content-end",children:l("b",{children:"Totol"})}),l(s,{md:"3",className:"d-flex justify-content-end",children:l("b",{children:(Q=p==null?void 0:p.summary)==null?void 0:Q.reduce((e,d)=>e+parseInt(d==null?void 0:d.count),0)})})]})]}):l("span",{className:"d-flex justify-content-center align-items-center",children:"Nothing Found"})}),l(s,{md:"2",children:x?Array.isArray(x)?x==null?void 0:x.map((e,d)=>{var f,a,G,Y,b,X,V,W;return r(P,{className:"mb-1",children:[l(Z,{children:l("h5",{children:d.replace("_"," ")+" "+(e==null?void 0:e.TOTAL)})}),r(J,{children:[l("b",{children:"STAGED XML"}),((f=e==null?void 0:e.STAGED_XML)==null?void 0:f.length)>0?(a=e==null?void 0:e.STAGED_XML)==null?void 0:a.map((E,T)=>r("div",{children:[E," ",l("br",{})]},T)):r("div",{children:["Nothing",l("br",{})]}),l("b",{children:"HOT FOLDER"}),((G=e==null?void 0:e.HOT_FOLDER)==null?void 0:G.length)>0?(Y=e==null?void 0:e.HOT_FOLDER)==null?void 0:Y.map((E,T)=>r("div",{children:[E," ",l("br",{})]},T)):r("div",{children:["Nothing",l("br",{})]}),l("b",{children:"RIP_QUEUE"}),((b=e==null?void 0:e.RIP_QUEUE)==null?void 0:b.length)>0?(X=e==null?void 0:e.RIP_QUEUE)==null?void 0:X.map((E,T)=>r("div",{children:[E," ",l("br",{})]},T)):r("div",{children:["Nothing",l("br",{})]}),l("b",{children:"PRINT_QUEUE"}),((V=e==null?void 0:e.PRINT_QUEUE)==null?void 0:V.length)>0?(W=e==null?void 0:e.PRINT_QUEUE)==null?void 0:W.map((E,T)=>r("div",{children:[E," ",l("br",{})]},T)):r("div",{children:["Nothing",l("br",{})]})]})]},mn)}):l("h5",{children:x}):r("span",{className:"d-flex justify-content-center align-items-center",children:[l(z,{size:"sm",className:"mx-1"}),"QUEUE is loading..."]})})]})})]})]})};export{mn as default};
