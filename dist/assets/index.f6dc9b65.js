import{a as X,r as $,cv as H,cw as J,cx as W,cy as Z,j as e,f as i,Q as M,X as g,Y as s,a0 as k,G as b,V as R,ab as aa,N as Q,n as q,$ as ea,ac as ca,cz as la,cA as sa,cB as na,ad as ra}from"./index.8b10020f.js";/* empty css                  */import{a as da}from"./App.6aecf595.js";/* empty css                                  */import{F as z}from"./index.17631888.js";import{S as y}from"./react-select.esm.f6728b2e.js";import"./emotion-memoize.esm.06f0e458.js";const va=()=>{var D,w,E,L,j;const m=da(),a=X(c=>c.previewBatches),[C,O]=$.exports.useState(!1),p=a==null?void 0:a.searchParams;$.exports.useEffect(()=>{u()},[a==null?void 0:a.params,a==null?void 0:a.active]),$.exports.useEffect(()=>{m(H()),m(J()),m(W())},[]);const u=async()=>{O(!0),await m(Z()),O(!1)},v=c=>{m(la(c))},B=c=>{(a==null?void 0:a.active)!==c&&m(sa(c))},P=()=>{m(na())},G=c=>{var d,N;let n=[...(N=(d=a==null?void 0:a.searchParams)==null?void 0:d.batches)!=null?N:[]];n!=null&&n.includes(c)?n=n==null?void 0:n.filter(o=>o!==c):n=[...n,c],v({batches:n})},K=(c,n,d,N)=>{var _,f;let o=[...(f=(_=a==null?void 0:a.searchParams)==null?void 0:_.batches)!=null?f:[]];d==null||d.forEach(r=>{let t=`${c}|${n}|${r==null?void 0:r.item_table_id}|${r==null?void 0:r.batch}|${r==null?void 0:r.store_id}`;N?o=[...o,t]:o=o==null?void 0:o.filter(l=>l!==t)}),v({batches:o})},U=(c,n,d)=>{var _,f;let N=[...(f=(_=a==null?void 0:a.searchParams)==null?void 0:_.batches)!=null?f:[]],o=!0;return d==null||d.forEach(r=>{let t=`${c}|${n}|${r==null?void 0:r.item_table_id}|${r==null?void 0:r.batch}|${r==null?void 0:r.store_id}`;!(N!=null&&N.includes(t))&&o&&(o=!1)}),o},V=(c,n)=>{var o,_;let d=[...(_=(o=a==null?void 0:a.searchParams)==null?void 0:o.batches)!=null?_:[]],N=0;c==null||c.forEach(f=>{var r;N++,(r=f==null?void 0:f.items)==null||r.forEach(t=>{let l=`${N}|${f==null?void 0:f.id}|${t==null?void 0:t.item_table_id}|${t==null?void 0:t.batch}|${t==null?void 0:t.store_id}`;n?d=[...d,l]:d=d==null?void 0:d.filter(x=>x!==l)})}),v({batches:d})},I=c=>{var N,o,_,f,r,t;let n=((N=a==null?void 0:a.data)==null?void 0:N.count)-1,d=((o=a==null?void 0:a.data)==null?void 0:o.serial)-1;return e(ra,{tabId:c,children:C?e("div",{className:"text-center",children:e("h4",{children:"Loading..."})}):((f=(_=a==null?void 0:a.data)==null?void 0:_.batch_routes)==null?void 0:f.length)>0?i("span",{children:[i(g,{children:[e(s,{sm:"2",className:"p-1 border",children:e("b",{children:"Batch #"})}),e(s,{sm:"1",className:"p-1 border",children:e("b",{children:"S.L #"})}),e(s,{sm:"1",className:"p-1 border",children:e("b",{children:"Batch S.L #"})}),e(s,{sm:"2",className:"border",children:i("b",{children:["Item ID ",e("br",{}),"Order #"]})}),e(s,{sm:"3",className:" border",children:i("b",{children:["Order date",e("br",{}),"Store"]})}),e(s,{sm:"1",className:"p-1 border",children:e("b",{children:"SKU"})}),e(s,{sm:"2",className:"p-1 border",children:e("b",{children:"Quantity"})})]}),(t=(r=a==null?void 0:a.data)==null?void 0:r.batch_routes)==null?void 0:t.map(l=>{var A;var x=0;n++;const F=n;return i("div",{className:"p-1 border",children:[i(g,{children:[e(s,{sm:"1",className:"p-1 ",children:n}),i(s,{sm:"3",className:"p-1 ",children:["Route: ",l.batch_code," ="," ",l.batch_route_name]}),e(s,{sm:"1",className:"p-1",children:e(k,{type:"checkbox",checked:U(F,l==null?void 0:l.id,l==null?void 0:l.items),onChange:h=>{var S;h==null||h.preventDefault(),K(F,l==null?void 0:l.id,l==null?void 0:l.items,(S=h.target)==null?void 0:S.checked)}})}),i(s,{sm:"7",className:"p-1 ",children:["Next station ",">>>"," ",l.next_station,e("hr",{})]})]},l.id),(A=l==null?void 0:l.items)==null?void 0:A.map(h=>{var T,Y;d++,x++;const S=`${n}|${l==null?void 0:l.id}|${h==null?void 0:h.item_table_id}|${h==null?void 0:h.batch}|${h==null?void 0:h.store_id}`;return i(g,{children:[e(s,{sm:"2",className:"p-1",children:e("img",{src:h.item_thumb,alt:"Item Thumbnail",height:60})}),e(s,{sm:"1",className:"p-1",children:d}),e(s,{sm:"1",className:"p-1",children:x}),i(s,{sm:"2",className:"p-1 d-flex",children:[e("div",{className:"d-flex align-items-center",children:e(k,{type:"checkbox",id:"locked",name:"locked",checked:(Y=(T=a==null?void 0:a.searchParams)==null?void 0:T.batches)==null?void 0:Y.includes(S),onChange:ia=>{G(S)}})}),i("div",{className:"px-1",children:["***",h.item_table_id,e("br",{}),e("a",{href:`/customer-order-edit/${h.order_5p}`,target:"_blank",children:h.short_order})]})]}),i(s,{sm:"3",className:"p-1",children:[h.order_date.substring(0,10),e("br",{}),h.store_name]}),e(s,{sm:"1",className:"p-1",children:h.item_code}),e(s,{sm:"2",className:"p-1",children:h.quantity})]})}),i(g,{children:[e(s,{sm:"10",className:"p-1"}),e(s,{sm:"2",className:"p-1",children:i("span",{children:[x-1," of ",l.batch_max_units," Max"]})})]})]})})]}):e("h4",{className:"text-center",children:"No batches to create."})})};return e("div",{className:"app-user-list",children:i($.exports.Fragment,{children:[i(M,{className:"p-2",children:[i(g,{className:"mb-1",children:[e(s,{sm:"2",children:e(k,{type:"text",id:"search_for_first",name:"search_for_first",placeholder:"Search for",value:p==null?void 0:p.search_for_first,onChange:c=>{var n;return v({search_for_first:(n=c==null?void 0:c.target)==null?void 0:n.value})}})}),e(s,{sm:"2",children:e(y,{className:"react-select",classNamePrefix:"select",placeholder:"Search in",options:a==null?void 0:a.searchInOptions,value:(D=a==null?void 0:a.searchInOptions)==null?void 0:D.find(c=>(c==null?void 0:c.value)==(p==null?void 0:p.search_in_first)),onChange:c=>v({search_in_first:c==null?void 0:c.value})})}),e(s,{sm:"2",children:e(y,{className:"react-select",classNamePrefix:"select",placeholder:"Select Store",options:a==null?void 0:a.storeOptions,value:(w=a==null?void 0:a.storeOptions)==null?void 0:w.find(c=>(c==null?void 0:c.value)==(p==null?void 0:p.store)),onChange:c=>v({store:c==null?void 0:c.value})})}),e(s,{sm:"2",children:e(y,{className:"react-select",classNamePrefix:"select",placeholder:"Select Section",options:a==null?void 0:a.sectionOptions,value:(E=a==null?void 0:a.sectionOptions)==null?void 0:E.find(c=>(c==null?void 0:c.value)==(p==null?void 0:p.section)),onChange:c=>v({section:c==null?void 0:c.value})})}),e(s,{sm:"2",children:e(z,{className:"form-control",id:"date",placeholder:"Order Start Date",value:(L=p==null?void 0:p.start_date)!=null?L:null,options:{dateFormat:"d-m-Y"},onChange:c=>v({start_date:c[0]})})}),e(s,{sm:"2",children:e(z,{className:"form-control",id:"date",placeholder:"Order End Date",value:(j=p==null?void 0:p.end_date)!=null?j:null,options:{dateFormat:"d-m-Y"},onChange:c=>v({end_date:c[0]})})})]}),i(g,{className:"mb-1",children:[e(s,{sm:"11"}),e(s,{sm:"1",className:"d-flex justify-content-end",children:e(b,{color:"primary",onClick:u,disabled:C,children:C?"Searching":"Search"})})]})]}),e(M,{children:e(R,{children:i(g,{children:[i(aa,{pills:!0,className:"mb-2 orange d-flex justify-content-between",children:[i("div",{className:"d-flex",children:[e(Q,{children:e(q,{active:(a==null?void 0:a.active)==="0",onClick:()=>{B("0")},children:"In Stock"})}),e(Q,{children:e(q,{active:(a==null?void 0:a.active)==="1",onClick:()=>{B("1")},children:"Back Orders"})})]}),i("div",{className:"d-flex",children:[i("div",{className:"mx-2 d-flex align-items-center justify-content-center",children:[e(k,{type:"checkbox",onChange:c=>{var n,d;c==null||c.preventDefault(),V((n=a==null?void 0:a.data)==null?void 0:n.batch_routes,(d=c.target)==null?void 0:d.checked)}}),e(ea,{className:"mx-1",children:"Select / Deselect all"})]}),a!=null&&a.locked?e(b,{color:"primary",onClick:P,children:"Create Batches"}):e(b,{color:"primary",onClick:P,children:"Auto Batch Running"})]})]}),i(ca,{activeTab:a==null?void 0:a.active,children:[I("0"),I("1")]})]})})})]})})};export{va as default};
