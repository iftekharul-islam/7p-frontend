import{k as nn,a as K,r as T,f as r,X as g,j as e,Y as s,L as j,a0 as c,G as u,Z as H,P as en,cz as ln,cA as rn,cB as sn,Q as b,S as V,V as W,bo as G,cC as Z,cD as dn,cE as on,cF as tn}from"./index.fb2a22ed.js";/* empty css                  */import{a as w}from"./App.3770f8d8.js";import{h as q}from"./moment.4d75c86c.js";import{F as J}from"./index.7db57e77.js";import{S as F}from"./react-select.esm.578f970a.js";import"./emotion-memoize.esm.06f0e458.js";const an=(y,p)=>{var X,L;const x=w();nn();const{data:i,printerOptions:M}=K(n=>n.printSublimations),[m,R]=T.exports.useState([]),[$,U]=T.exports.useState(null),[k,h]=T.exports.useState(null),A=async()=>{try{const n=await en.get($);h(n.data)}catch(n){console.error("Error fetching XML:",n)}};T.exports.useEffect(()=>{$&&A()},[$]),T.exports.useEffect(()=>{var n,_;((n=i==null?void 0:i.batches)==null?void 0:n.length)>0&&R((_=i==null?void 0:i.batches)==null?void 0:_.map(t=>({batch_number:t==null?void 0:t.batch_number})))},[i==null?void 0:i.batches]);const C=(n,_,t)=>{const O=m==null?void 0:m.find(l=>(l==null?void 0:l.batch_number)==n),E=m==null?void 0:m.filter(l=>(l==null?void 0:l.batch_number)!=n);R([...E,{...O,[_]:t}])},f=async n=>{C(n,"loader",!0);const _=m==null?void 0:m.find(t=>(t==null?void 0:t.batch_number)==n);if(_){const t=await x(ln(_));t!=null&&t.payload&&window.open(t==null?void 0:t.payload,"_blank")}else alert("Please select Printer");C(n,"loader",!1)};return r("span",{children:[r(g,{children:[e("div",{children:k?e("a",{href:`data:text/xml;charset=utf-8,${encodeURIComponent(k)}`,download:"data.xml",children:"Download XML"}):e("p",{children:"Loading XML..."})}),r("h5",{children:[(X=i==null?void 0:i.batches)==null?void 0:X.length," batches found"]}),e("hr",{})]}),(L=i==null?void 0:i.batches)==null?void 0:L.map((n,_)=>{var t,O,E,l,a,S,D,I,Q,P;return e("span",{children:r(g,{className:(n==null?void 0:n.to_printer_date)!=null&&"bg-info",children:[r(s,{sm:"3",children:[e(j,{to:`/batch-list/${n==null?void 0:n.batch_number}`,children:r("strong",{children:[n==null?void 0:n.batch_number,"-"]})}),((t=n==null?void 0:n.items)==null?void 0:t.length)>1&&r("span",{children:[(O=n==null?void 0:n.items)==null?void 0:O.length," Items-"]}),(n==null?void 0:n.store_id)&&e("strong",{className:"text-danger",children:(a=(l=(E=i==null?void 0:i.stores)==null?void 0:E.find(d=>(d==null?void 0:d.value)==(n==null?void 0:n.store_id)))==null?void 0:l.label)!=null?a:null}),e("div",{children:n.route.csv_extension.toLowerCase().includes("soft")?r("div",{className:"button-box print-group",children:[r(s,{lg:"3",children:[e(c,{type:"hidden",name:"batch_number",value:n.batch_number}),e(c,{type:"hidden",name:"printer",value:"SOFT-1"}),e(u,{id:`move_${n.batch_number}`,className:"btn btn-xs btn-primary",onClick:()=>f(n.batch_number),children:"SOFT-1"})]}),r(s,{lg:"3",children:[e(c,{type:"hidden",name:"batch_number",value:n.batch_number}),e(c,{type:"hidden",name:"printer",value:"SOFT-2"}),e(u,{id:`move_${n.batch_number}`,className:"btn btn-xs btn-info",onClick:()=>f(n.batch_number),children:"SOFT-2"})]}),e(s,{lg:"3",children:r(H,{id:`move_form_${n.batch_number}${Math.floor(Math.random()*90)+10}`,children:[e(c,{type:"hidden",name:"batch_number",value:n.batch_number}),e(c,{type:"hidden",name:"printer",value:"SOFT-3"}),e(u,{id:`move_${n.batch_number}`,className:"btn btn-xs btn-primary",onClick:()=>f(n.batch_number),children:"SOFT-3"})]})}),e(s,{lg:"3",children:r(H,{id:`move_form_${n.batch_number}${Math.floor(Math.random()*90)+10}`,children:[e(c,{type:"hidden",name:"batch_number",value:n.batch_number}),e(c,{type:"hidden",name:"printer",value:"EPSON-5"}),e(u,{id:`move_${n.batch_number}`,className:"btn btn-xs btn-warning",onClick:()=>f(n.batch_number),children:"EPSON-5"})]})})]}):n.route.csv_extension.toLowerCase().includes("hard")?r("div",{className:"button-box print-group",children:[e(s,{lg:"4",children:r(H,{id:`move_form_${n.batch_number}${Math.floor(Math.random()*90)+10}`,children:[e(c,{type:"hidden",name:"batch_number",value:n.batch_number}),e(c,{type:"hidden",name:"printer",value:"HARD-1"}),e(u,{id:`move_${n.batch_number}`,className:"btn btn-xs btn-danger",onClick:()=>f(n.batch_number),children:"Send to HARD-1"})]})}),e(s,{lg:"4",children:r(H,{id:`move_form_${n.batch_number}${Math.floor(Math.random()*90)+10}`,children:[e(c,{type:"hidden",name:"batch_number",value:n.batch_number}),e(c,{type:"hidden",name:"printer",value:"HARD-2"}),e(u,{id:`move_${n.batch_number}`,className:"btn btn-xs btn-success",onClick:()=>f(n.batch_number),children:"Send to HARD-2"})]})}),e(s,{lg:"4",children:r(H,{id:`move_form_${n.batch_number}${Math.floor(Math.random()*90)+10}`,children:[e(c,{type:"hidden",name:"batch_number",value:n.batch_number}),e(c,{type:"hidden",name:"printer",value:"HARD-3"}),e(u,{id:`move_${n.batch_number}`,className:"btn btn-xs btn-danger",onClick:()=>f(n.batch_number),children:"Send to HARD-3"})]})})]}):e("div",{className:"print-group",children:r(s,{xs:"12",children:[e(F,{className:"react-select",classNamePrefix:"select",options:M,onChange:d=>{C(n==null?void 0:n.batch_number,"printer",d==null?void 0:d.value)},placeholder:"Select Printer"}),e(u,{color:"primary",onClick:()=>f(n.batch_number),children:(S=m==null?void 0:m.find(d=>(d==null?void 0:d.batch_number)==(n==null?void 0:n.batch_number)))!=null&&S.loader?"Loading":"Send"})]})})})]}),e(s,{sm:"1",children:e("a",{href:`/batch-list/${n==null?void 0:n.batch_number}`,children:e("img",{src:(D=n==null?void 0:n.items[0])==null?void 0:D.item_thumb,alt:"print",width:"50px",height:"50px"})})}),r(s,{sm:"3",children:[(n==null?void 0:n.type)==="P"&&e("div",{children:e("strong",{style:{color:"red"},children:"IN PRODUCTION:"})}),(n==null?void 0:n.type)==="Q"&&e("div",{children:e("strong",{style:{color:"red"},children:"IN QC:"})}),n!=null&&n.production_station?r("div",{children:["Give to: ",(I=n==null?void 0:n.production_station)==null?void 0:I.station_description]}):r("div",{children:["PRODUCTION STATION NOT FOUND: ",n==null?void 0:n.production_station_id]}),(n==null?void 0:n.status)!=="active"&&r("div",{children:["Batch Status:"," ",e("strong",{style:{color:"red"},children:n==null?void 0:n.status})]}),e("br",{}),"First Order Date:"," ",q(n==null?void 0:n.min_order_date).format("DD-MM-YYYY")]}),r(s,{sm:"1",children:["Graphic",e("br",{}),"QTY: ",(Q=n==null?void 0:n.items[0])==null?void 0:Q.item_quantity]}),e(s,{sm:"1",children:((n==null?void 0:n.graphic_found)=="Found"||(n==null?void 0:n.graphic_found)=="Unknown")&&e("a",{href:"batches/view_graphic?batch_number=%s",target:"_blank",children:"View Graphics"})}),r(s,{sm:"2",children:[r("div",{className:"d-flex align-items-center",children:[e("span",{children:"Scale: "}),e(c,{onChange:d=>{var v;return C(n==null?void 0:n.batch_number,"scale",(v=d==null?void 0:d.target)==null?void 0:v.value)}}),"%"]}),r("div",{children:["pdf"," ",e(c,{type:"checkbox",onChange:d=>{var v;return C(n==null?void 0:n.batch_number,"pdf",(v=d==null?void 0:d.target)==null?void 0:v.checked)}})]})]}),r(s,{sm:"1",children:[e("div",{children:"Rejects"}),(P=n==null?void 0:n.items)==null?void 0:P.map((d,v)=>{var Y;d!=null&&d.rejections&&((Y=d==null?void 0:d.rejections)==null||Y.map((o,N)=>{var B,z;return r(g,{children:[e(s,{sm:"3"}),r(s,{sm:"9",children:["Item ",d==null?void 0:d.id," Rejected ",o==null?void 0:o.created_at,"by ",(B=o==null?void 0:o.user)==null?void 0:B.username,(o==null?void 0:o.rejection_reason_info)&&"-"+((z=o==null?void 0:o.rejection_reason_info)==null?void 0:z.rejection_message),"- ",o==null?void 0:o.rejection_message]})]},N)}))})]}),e("hr",{})]},_)})})]})},cn=()=>{var L,n,_,t,O,E;const y=w(),{data:p,queues:x,searchParams:i,printerOptions:M,typeOption:m,stationsOptions:R,storeOptions:$}=K(l=>l.printSublimations),[U,k]=T.exports.useState(!1),h=l=>{y(Z(l))},A=async()=>{k(!0),await y(dn()),k(!1)},C=async()=>{await y(on())},f=()=>{y(tn())},X=async l=>{await y(Z({production_station_id:[l]})),A()};return T.exports.useEffect(()=>{A(),y(rn()),y(sn()),C()},[]),r(b,{children:[e(V,{children:e("h4",{children:"Send Graphics to Printer"})}),r(W,{children:[r(g,{className:"mb-1",children:[e(s,{md:"7"}),e(s,{md:"3",children:e(F,{className:"react-select",classNamePrefix:"select",options:M,value:M.find(l=>l.value===(i==null?void 0:i.printer)),onChange:l=>{h({printer:l==null?void 0:l.value})}})}),e(s,{md:"2",children:e(u,{color:"primary",onClick:f,children:"Print All"})})]}),r(b,{className:"border rounded",children:[r(g,{className:"m-1",children:[e(s,{md:"1",children:e(c,{type:"text",placeholder:"Batch Number",value:i==null?void 0:i.select_batch,onChange:l=>{h({...i,select_batch:l.target.value})}})}),e(s,{md:"1",children:e(F,{className:"react-select",classNamePrefix:"select",placeholder:"Type",options:m,value:m.find(l=>l.value===(i==null?void 0:i.type)),onChange:l=>{h({type:l==null?void 0:l.value})}})}),e(s,{md:"3",children:e(F,{className:"react-select",classNamePrefix:"select",placeholder:"Select Section",isMulti:!0,options:R,value:R.filter(l=>{var a;return(a=i==null?void 0:i.production_station_id)==null?void 0:a.includes(l.value)}),onChange:l=>{h({...i,production_station_id:l==null?void 0:l.map(a=>a.value)})}})}),e(s,{md:"3",children:e(F,{className:"react-select",classNamePrefix:"select",placeholder:"Select Store",isMulti:!0,options:$,value:$.filter(l=>{var a;return(a=i==null?void 0:i.store_id)==null?void 0:a.includes(l.value)}),onChange:l=>{h({...i,store_id:l==null?void 0:l.map(a=>a.value)})}})}),e(s,{md:"2",children:e(J,{className:"form-control",placeholder:"From",value:(L=i==null?void 0:i.from_date)!=null?L:null,options:{dateFormat:"d-m-Y"},onChange:l=>h({from_date:l[0]})})}),e(s,{md:"2",children:e(J,{className:"form-control",placeholder:"To",value:(n=i==null?void 0:i.to_date)!=null?n:null,options:{dateFormat:"d-m-Y"},onChange:l=>h({to_date:l[0]})})})]}),r(g,{className:"m-1 mt-0",children:[e(s,{md:"10",children:e(F,{className:"react-select",classNamePrefix:"select",placeholder:"Mass set a printer",options:M,value:M.find(l=>l.value===(i==null?void 0:i.set_printer)),onChange:l=>{h({set_printer:l==null?void 0:l.value})}})}),e(s,{md:"2",children:e(u,{color:"primary",onClick:A,disabled:U,children:U?r("span",{className:"d-flex justify-content-center",children:[e(G,{size:"sm"}),"Wait..."]}):"Show"})})]})]}),e(b,{children:U?r("span",{className:"d-flex justify-content-center align-items-center",children:[e("span",{className:"mx-1",children:e(G,{size:"sm"})}),"Data Loading..."]}):r(g,{children:[e(s,{md:"10",children:((_=p==null?void 0:p.batches)==null?void 0:_.length)>0?e(an,{loading:U,setLoading:k}):((t=p==null?void 0:p.summary)==null?void 0:t.length)>0?r("span",{children:[r(g,{children:[e(s,{md:"6",className:"d-flex justify-content-start",children:e("b",{children:"Production Station"})}),e(s,{md:"3",className:"d-flex justify-content-center",children:e("b",{children:"First order"})}),e(s,{md:"3",className:"d-flex justify-content-end",children:e("b",{children:"Batches"})})]}),(O=p==null?void 0:p.summary)==null?void 0:O.map((l,a)=>{var S;return r("span",{children:[e("hr",{}),r(g,{children:[e(s,{md:"6",className:"d-flex justify-content-start",children:(S=l==null?void 0:l.production_station)==null?void 0:S.station_description}),e(s,{md:"3",className:"d-flex justify-content-center",children:q(l==null?void 0:l.date).format("YYYY-MM-DD")}),e(s,{md:"3",className:"d-flex justify-content-end",children:e(j,{onClick:D=>{D.preventDefault(),X(l==null?void 0:l.production_station_id)},children:l==null?void 0:l.count})})]})]},a)}),e("hr",{}),r(g,{children:[e(s,{md:"6"}),e(s,{md:"3",className:"d-flex justify-content-end",children:e("b",{children:"Totol"})}),e(s,{md:"3",className:"d-flex justify-content-end",children:e("b",{children:(E=p==null?void 0:p.summary)==null?void 0:E.reduce((l,a)=>l+parseInt(a==null?void 0:a.count),0)})})]})]}):e("span",{className:"d-flex justify-content-center align-items-center",children:"Nothing Found"})}),e(s,{md:"2",children:x?Array.isArray(x)?x==null?void 0:x.map((l,a)=>{var S,D,I,Q,P,d,v,Y;return r(b,{className:"mb-1",children:[e(V,{children:e("h5",{children:a.replace("_"," ")+" "+(l==null?void 0:l.TOTAL)})}),r(W,{children:[e("b",{children:"STAGED XML"}),((S=l==null?void 0:l.STAGED_XML)==null?void 0:S.length)>0?(D=l==null?void 0:l.STAGED_XML)==null?void 0:D.map((o,N)=>r("div",{children:[o," ",e("br",{})]},N)):r("div",{children:["Nothing",e("br",{})]}),e("b",{children:"HOT FOLDER"}),((I=l==null?void 0:l.HOT_FOLDER)==null?void 0:I.length)>0?(Q=l==null?void 0:l.HOT_FOLDER)==null?void 0:Q.map((o,N)=>r("div",{children:[o," ",e("br",{})]},N)):r("div",{children:["Nothing",e("br",{})]}),e("b",{children:"RIP_QUEUE"}),((P=l==null?void 0:l.RIP_QUEUE)==null?void 0:P.length)>0?(d=l==null?void 0:l.RIP_QUEUE)==null?void 0:d.map((o,N)=>r("div",{children:[o," ",e("br",{})]},N)):r("div",{children:["Nothing",e("br",{})]}),e("b",{children:"PRINT_QUEUE"}),((v=l==null?void 0:l.PRINT_QUEUE)==null?void 0:v.length)>0?(Y=l==null?void 0:l.PRINT_QUEUE)==null?void 0:Y.map((o,N)=>r("div",{children:[o," ",e("br",{})]},N)):r("div",{children:["Nothing",e("br",{})]})]})]},cn)}):e("h5",{children:x}):r("span",{className:"d-flex justify-content-center align-items-center",children:[e(G,{size:"sm",className:"mx-1"}),"QUEUE is loading..."]})})]})})]})]})};export{cn as default};
