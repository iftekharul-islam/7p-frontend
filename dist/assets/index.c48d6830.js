import{a as I,r as S,az as D,f as d,aA as X,j as e,aB as ee,aC as re,a0 as j,aD as ne,G as k,aE as de,Q as Z,S as w,T as le,V as $,aF as ce,X as _,Y as l,L as te,aG as ae,aH as se,aI as oe}from"./index.7687a0d9.js";import{S as ie}from"./react-select.esm.ab88828b.js";import{a as P}from"./App.c5a53fe9.js";import{h as he}from"./moment.4d75c86c.js";import"./emotion-memoize.esm.06f0e458.js";const pe=({isOpen:n,toggle:u,data:h})=>{const s=P(),{rejectOptions:t}=I(r=>r.batchList),[i,c]=S.exports.useState(null),o=(r,p)=>{c({...i,[r]:p})},a=r=>{o(r.target.name,r.target.value)},g=async()=>{const r=s(de(i));(r==null?void 0:r.payload)==201&&(setRejectShow(!rejectShow),getBatchData())};return S.exports.useEffect(()=>{s(D()),c({id:h==null?void 0:h.id,item_id:h==null?void 0:h.item_id,origin:"BD",title:"Batch view"})},[h]),d(X,{isOpen:n,toggle:u,className:"modal-lg",children:[e(ee,{toggle:u,children:"Reject Information"}),d(re,{children:[e("h5",{children:"Inventory"}),d("div",{className:"btn-group","data-toggle":"buttons",children:[d("label",{className:"btn btn-default btn-lg",style:{width:"280px"},children:[e("span",{className:"glyphicon glyphicon-trash"}),e(j,{type:"radio",name:"scrap",value:"1",onChange:a})," ","Defective Item Produced"]}),d("label",{className:"btn btn-default btn-lg",style:{width:"280px"},children:[e(j,{type:"radio",name:"scrap",value:"0",onChange:a})," ","Nothing Produced"]})]}),e("hr",{}),d("div",{className:"btn-group","data-toggle":"buttons",children:[e("h5",{children:"Graphic"}),d("label",{className:"btn btn-default btn-lg",style:{width:"180px"},children:[e("span",{className:"glyphicon glyphicon-print"}),e(j,{type:"radio",name:"graphic_status",value:"1",onChange:a})," ","Print Again"]}),d("label",{className:"btn btn-default btn-lg",style:{width:"180px"},children:[e("span",{className:"glyphicon glyphicon-pencil"}),e(j,{type:"radio",name:"graphic_status",value:"2",onChange:a})," ","Edit Graphic"]}),d("label",{className:"btn btn-default btn-lg",style:{width:"205px"},children:[e("span",{className:"glyphicon glyphicon-envelope"}),e(j,{type:"radio",name:"graphic_status",value:"4",onChange:a})," ","Contact Customer"]})]}),e("hr",{}),d("div",{className:"form-group",id:"qty_group",children:["Quantity to Reject:"," ",e(j,{type:"number",id:"reject_qty",name:"reject_qty",value:i==null?void 0:i.reject_qty,min:"1",onChange:a})]}),e("div",{className:"form-group",children:e(ie,{className:"select",classNamePrefix:"react-select",name:"rejection_reason",options:t,value:t==null?void 0:t.find(r=>r.value===(i==null?void 0:i.reasonToReject)),onChange:r=>o("rejection_reason",r.value),children:e("option",{value:"",children:"Select a reason to reject"})})}),e("div",{className:"form-group",children:e(j,{type:"textarea",id:"rejection_message",rows:2,className:"form-control",placeholder:"More Information",name:"rejection_message",value:i==null?void 0:i.rejection_message,onChange:a})})]}),d(ne,{children:[e(k,{color:"default",onClick:u,className:"btn-lg modal-close",children:"Close"}),e(k,{color:"danger",onClick:g,className:"btn-lg",children:"Reject"})]})]})},ue=({show:n,handleClose:u,handleUpload:h,uploadData:s,FileUpload:t})=>e(X,{isOpen:n,toggle:u,className:"modal-lg",children:d(Z,{children:[e(w,{closeButton:!0,children:e(le,{children:"Upload a Graphic"})}),d($,{children:[e("p",{children:"Upload a graphic to the Archive directory."}),e(j,{type:"file",className:"form-control",onChange:o=>{o.preventDefault();const a=new FileReader,g=o.target.files[0];a.onloadend=()=>{h({...s,upload_file:g})},a.readAsDataURL(g)}})]}),d(ce,{children:[e(k,{className:"success",onClick:async o=>{o.preventDefault(),s!=null&&s.upload_file?(await t(s),u()):alert("Please select a file to upload")},children:"Upload"}),e(k,{className:"secondary mx-1",onClick:u,children:"Close"})]})]})}),be=()=>{var u,h,s,t,i,c,o,a,g,r,p,y,x,N,v,C,f,b,R,m,B,U,F,E,G,M,T,A,O,q,Y,Q,z,H,V,J,K,W;const{showData:n}=I(L=>L.batchList);return d($,{children:[d(_,{className:"p-1 pt-0",children:[d(l,{md:"1",children:[e("b",{children:"**Route:"})," "]}),e(l,{md:"9",children:((u=n==null?void 0:n.batch)==null?void 0:u.route)&&e("span",{children:d("span",{children:[(s=(h=n==null?void 0:n.batch)==null?void 0:h.route)==null?void 0:s.batch_code,"/",(i=(t=n==null?void 0:n.batch)==null?void 0:t.route)==null?void 0:i.batch_route_name," => ",n==null?void 0:n.stations]})})}),e(l,{md:"2",children:(o=(c=n==null?void 0:n.batch)==null?void 0:c.route)!=null&&o.template?d("span",{children:[(r=(g=(a=n==null?void 0:n.batch)==null?void 0:a.route)==null?void 0:g.template)==null?void 0:r.template_name," Template"]}):e("span",{children:"No Template"})})]}),d(_,{className:"p-1 pt-0",children:[e(l,{md:"1",children:e("b",{children:"Created:"})}),e(l,{md:"3",children:(p=n==null?void 0:n.batch)==null?void 0:p.creation_date}),e(l,{md:"1",children:e("b",{children:"Last Scan:"})}),e(l,{md:"3",children:(y=n==null?void 0:n.last_scan)!=null&&y.date?((x=n==null?void 0:n.last_scan)==null?void 0:x.date)+" by "+((N=n==null?void 0:n.last_scan)==null?void 0:N.username):(v=n==null?void 0:n.batch)==null?void 0:v.change_date}),e(l,{md:"1",children:e("b",{children:"Station:"})}),e(l,{md:"3",children:(C=n==null?void 0:n.batch)!=null&&C.station?((b=(f=n==null?void 0:n.batch)==null?void 0:f.station)==null?void 0:b.station_name)+" => "+((m=(R=n==null?void 0:n.batch)==null?void 0:R.station)==null?void 0:m.station_description):"Station Not Found"})]}),d(_,{className:"p-1 pt-0",children:[e(l,{md:"1",children:e("b",{children:"Export:"})}),e(l,{md:"3",children:(B=n==null?void 0:n.batch)!=null&&B.export_date?((U=n==null?void 0:n.batch)==null?void 0:U.export_count)==1?d("span",{children:["Exported ",(F=n==null?void 0:n.batch)==null?void 0:F.export_count," time"," ",(E=n==null?void 0:n.batch)==null?void 0:E.export_date]}):d("span",{children:["Exported ",(G=n==null?void 0:n.batch)==null?void 0:G.export_count," times Last export"," ",(M=n==null?void 0:n.batch)==null?void 0:M.export_date]}):"Not Exported"}),e(l,{md:"4",children:((T=n==null?void 0:n.batch)==null?void 0:T.csv_found)!=0&&"CSV File Found"})]}),d(_,{className:"p-1 pt-0",children:[e(l,{md:"1",children:e("b",{children:"Summary:"})}),(A=n==null?void 0:n.batch)!=null&&A.summary_date?e(l,{md:"6",children:d(_,{children:[d(l,{md:"6",children:["Printed ",(O=n==null?void 0:n.batch)==null?void 0:O.summary_date]}),d(l,{md:"6",children:[(q=n==null?void 0:n.batch)==null?void 0:q.summary_count," printed - last by"," ",(Q=(Y=n==null?void 0:n.batch)==null?void 0:Y.summary_user)==null?void 0:Q.username]})]})}):e(l,{md:"6",children:"Not Printed"})]}),d(_,{className:"p-1 pt-0",children:[e(l,{md:"1",children:e("b",{children:"Graphic:"})}),e(l,{md:"3",children:(z=n==null?void 0:n.batch)==null?void 0:z.graphic_found}),((H=n==null?void 0:n.batch)==null?void 0:H.to_printer)!="0"&&e(l,{md:"4",children:d(_,{children:[e(l,{md:"3",children:e("b",{children:"Printed:"})}),d(l,{md:"9",children:[(V=n==null?void 0:n.batch)==null?void 0:V.to_printer," -"," ",(J=n==null?void 0:n.batch)==null?void 0:J.to_printer_date]})]})})]}),((K=n==null?void 0:n.related)==null?void 0:K.length)>0&&d(_,{className:"p-1 pt-0",children:[e(l,{md:"1",children:e("b",{children:"Related:"})}),e(l,{md:"3",children:(W=n==null?void 0:n.related)==null?void 0:W.map(L=>d("span",{children:[L," "]}))})]})]})},_e=({batchNote:n,setBatchNote:u,onClick:h})=>{var t,i;const{showData:s}=I(c=>c.batchList);return d($,{children:[d(_,{children:[e(l,{md:"2",className:"p-1 border",children:e("b",{children:"Note"})}),e(l,{md:"1",className:"p-1 border",children:e("b",{children:"Date"})}),e(l,{md:"2",className:"p-1 border",children:e("b",{children:"User"})}),e(l,{md:"1",className:"p-1 border",children:e("b",{children:"Station"})}),e(l,{md:"2",className:"p-1 border",children:e("b",{children:"Station"})}),e(l,{md:"2",className:"p-1 border",children:e("b",{children:"Scan In"})}),e(l,{md:"2",className:"p-1 border",children:e("b",{children:"Scan Out"})})]}),d(_,{children:[e(l,{md:"6",children:(t=s==null?void 0:s.notes)==null?void 0:t.map(c=>{var o,a;return e("span",{children:d(_,{className:"p-1",children:[e(l,{md:"4",children:c==null?void 0:c.note}),e(l,{md:"2",children:he(c==null?void 0:c.created_at).format("DD MM YYYY")}),e(l,{md:"4",children:(o=c==null?void 0:c.user)==null?void 0:o.username}),e(l,{md:"2",children:(a=c==null?void 0:c.station)==null?void 0:a.station_name})]})})})}),e(l,{md:"6",children:(i=s==null?void 0:s.scans)==null?void 0:i.map(c=>{var o,a;return e("span",{children:d(_,{className:"p-1",children:[e(l,{md:"4",children:(o=c==null?void 0:c.station)==null?void 0:o.station_name}),d(l,{md:"4",children:[(a=c==null?void 0:c.in_user)==null?void 0:a.username," ",c==null?void 0:c.in_date]}),e(l,{md:"4",children:(c==null?void 0:c.out_user)&&c.out_user.username+" "+c.out_date})]})})})})]}),d(_,{children:[e(l,{md:"4",children:e(j,{type:"textarea",name:"note",id:"note",placeholder:"Enter Note",value:n,onChange:c=>{u(c.target.value)}})}),e(l,{md:"2",children:e(k,{color:"primary",onClick:h,children:"Add Note"})})]})]})},ge=({handleClose:n,setRejectData:u,handleRejectClose:h,setUploadData:s})=>{var a,g;P();const{showData:t}=I(r=>r.batchList),i=(r,p)=>{r.preventDefault(),s({item_id:p==null?void 0:p.id,batch_number:p==null?void 0:p.batch_number}),n()},c=r=>{u(r),h()},o=(r,p=`
`,y=0)=>{let x="",N="";y===1&&(x='<strong style="font-size: 110%;">',N="</strong>");let v="";const C=JSON.parse(r);if(C)for(const f in C){let b=C[f];f!=="Confirmation_of_Order_Details"&&f!=="couponcode"&&(typeof b===String&&(b==null?void 0:b.includes("$"))&&y===1&&(b=`<span style="font-size: 120%;">${b}</span>`),v+=`${f.replaceAll("_"," ")} = ${x}${b}${N}${p}`)}return v};return d($,{children:[d(_,{children:[e(l,{md:"1",className:"p-1 border"}),e(l,{md:"3",className:"p-1 border",children:e("b",{children:"Order"})}),e(l,{md:"2",className:"p-1 border"}),e(l,{md:"3",className:"p-1 border",children:e("b",{children:"Product"})}),e(l,{md:"3",className:"p-1 border",children:e("b",{children:"Options"})})]}),(g=(a=t==null?void 0:t.batch)==null?void 0:a.items)==null?void 0:g.map(r=>{var p,y,x,N,v,C,f,b,R;return d("span",{children:[d(_,{className:"p-1 border",children:[e(l,{md:"1",children:(r==null?void 0:r.item_status)==="production"||(r==null?void 0:r.item_status)==="wap"||(r==null?void 0:r.item_status)==="back order"?d(k,{color:"primary",onClick:()=>c({id:t==null?void 0:t.batch_number,item_id:r==null?void 0:r.id,origin:"BD"}),children:["Reject ",(r==null?void 0:r.item_status)=="wap"?" from Wap":""]}):e("span",{children:r.item_status.charAt(0).toUpperCase()+r.item_status.slice(1)})}),d(l,{md:"3",children:["Order:"," ",e(te,{to:`/customer-order-edit/${(p=r==null?void 0:r.order)==null?void 0:p.id}`,children:(y=r==null?void 0:r.order)==null?void 0:y.short_order}),e("br",{}),"Date : ",(x=r==null?void 0:r.order)==null?void 0:x.order_date,e("br",{}),"Store: ",(v=(N=r==null?void 0:r.order)==null?void 0:N.store)==null?void 0:v.store_name,e("br",{}),"Re Download Graphic: ",r==null?void 0:r.id,e("br",{}),((f=(C=t==null?void 0:t.batch)==null?void 0:C.station)==null?void 0:f.type)=="G"&&d(k,{color:"primary",onClick:m=>i(m,r),children:["Upload ",r==null?void 0:r.id," Graphic"]})]}),d(l,{md:"2",children:[(r==null?void 0:r.sure3d_thumb)&&e("img",{src:r==null?void 0:r.sure3d_thumb[0],width:"150",height:"150"}),e("a",{href:r==null?void 0:r.item_url,target:"_blank",children:e("img",{src:r==null?void 0:r.item_thumb,width:"150",height:"150"})})]}),d(l,{md:"3",children:[r==null?void 0:r.child_sku,e("br",{}),r==null?void 0:r.item_description,e("br",{}),"Item# ",r==null?void 0:r.id,e("br",{}),(r==null?void 0:r.item_quantity)===1?d("span",{children:["QTY: ",r==null?void 0:r.item_quantity]}):d("strong",{children:["QTY: ",r==null?void 0:r.item_quantity]}),e("br",{}),r.spec_sheet&&d("div",{children:[e("a",{href:`/products_specifications/${r.spec_sheet.id}`,target:"_blank",children:"Production Instruction"}),e("br",{})]}),r.supervisor_message&&d("div",{children:[r.supervisor_message,e("br",{})]}),r.tracking_number&&d("div",{style:{color:"red"},children:["TRK# ",r.tracking_number]})]}),e(l,{md:"3",children:e(j,{type:"textarea",Rows:"5",value:o(r==null?void 0:r.item_option),disabled:!0})})]}),((b=r==null?void 0:r.rejections)==null?void 0:b.length)&&((R=r==null?void 0:r.rejections)==null?void 0:R.map(m=>d(_,{className:"p-1 border",children:[e(l,{md:2}),d(l,{md:8,children:["Item ",r.id," Rejected ",m.created_at," by"," ",m.user.username,m.rejection_reason_info&&` - ${m.rejection_reason_info.rejection_message}`,"- ",m.rejection_message]})]})))]})})]})},xe=()=>{var R,m,B;const{id:n}=ae(),[u,h]=S.exports.useState(null),s=P(),{showData:t}=I(U=>U.batchList),[i,c]=S.exports.useState(!1),o=async()=>{c(!0),n&&await s(se({id:n,batchNote:u})),h(""),c(!1)};S.exports.useEffect(()=>{o()},[]);const[a,g]=S.exports.useState(!1),r=()=>g(!a),p=async U=>{await s(oe(U)),o(),g(!a)},[y,x]=S.exports.useState(!1),N=()=>x(!y),[v,C]=S.exports.useState(null),[f,b]=S.exports.useState(null);return d(S.exports.Fragment,{children:[d(Z,{children:[e(w,{children:d("h4",{className:"card-title",children:["Batch: ",t==null?void 0:t.batch_number," ",((R=t==null?void 0:t.batch)==null?void 0:R.store)&&"("+((B=(m=t==null?void 0:t.batch)==null?void 0:m.store)==null?void 0:B.store_name)+")"]})}),e(be,{}),e(ge,{handleClose:r,setUploadData:b,setRejectData:C,handleRejectClose:N}),e(_e,{batchNote:u,setBatchNote:h,onClick:o})]}),e(ue,{show:a,handleClose:r,uploadData:f,handleUpload:b,FileUpload:p}),e(pe,{isOpen:y,toggle:N,data:v})]})};export{xe as default};
