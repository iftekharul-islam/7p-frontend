import{a as B,r as S,az as D,f as l,aA as X,j as e,aB as ee,aC as re,a0 as j,aD as ne,G as k,aE as le,Q as Z,S as w,T as ce,V as U,aF as de,aG as te,X as b,Y as c,L as ae,aH as oe,aI as se}from"./index.48d1d48f.js";import{S as ie}from"./react-select.esm.8632f7ad.js";import{a as $}from"./App.c015087f.js";import{h as he}from"./moment.4d75c86c.js";import"./emotion-memoize.esm.06f0e458.js";const pe=({isOpen:r,toggle:u,data:h})=>{const o=$(),{rejectOptions:t}=B(n=>n.batchList),[s,d]=S.exports.useState(null),i=(n,p)=>{d({...s,[n]:p})},a=n=>{i(n.target.name,n.target.value)},f=async()=>{const n=o(le(s));(n==null?void 0:n.payload)==201&&(setRejectShow(!rejectShow),getBatchData())};return S.exports.useEffect(()=>{o(D()),d({id:h==null?void 0:h.id,item_id:h==null?void 0:h.item_id,origin:"BD",title:"Batch view"})},[h]),l(X,{isOpen:r,toggle:u,className:"modal-lg",children:[e(ee,{toggle:u,children:"Reject Information"}),l(re,{children:[e("h5",{children:"Inventory"}),l("div",{className:"btn-group","data-toggle":"buttons",children:[l("label",{className:"btn btn-default btn-lg",style:{width:"280px"},children:[e("span",{className:"glyphicon glyphicon-trash"}),e(j,{type:"radio",name:"scrap",value:"1",onChange:a})," ","Defective Item Produced"]}),l("label",{className:"btn btn-default btn-lg",style:{width:"280px"},children:[e(j,{type:"radio",name:"scrap",value:"0",onChange:a})," ","Nothing Produced"]})]}),e("hr",{}),l("div",{className:"btn-group","data-toggle":"buttons",children:[e("h5",{children:"Graphic"}),l("label",{className:"btn btn-default btn-lg",style:{width:"180px"},children:[e("span",{className:"glyphicon glyphicon-print"}),e(j,{type:"radio",name:"graphic_status",value:"1",onChange:a})," ","Print Again"]}),l("label",{className:"btn btn-default btn-lg",style:{width:"180px"},children:[e("span",{className:"glyphicon glyphicon-pencil"}),e(j,{type:"radio",name:"graphic_status",value:"2",onChange:a})," ","Edit Graphic"]}),l("label",{className:"btn btn-default btn-lg",style:{width:"205px"},children:[e("span",{className:"glyphicon glyphicon-envelope"}),e(j,{type:"radio",name:"graphic_status",value:"4",onChange:a})," ","Contact Customer"]})]}),e("hr",{}),l("div",{className:"form-group",id:"qty_group",children:["Quantity to Reject:"," ",e(j,{type:"number",id:"reject_qty",name:"reject_qty",value:s==null?void 0:s.reject_qty,min:"1",onChange:a})]}),e("div",{className:"form-group",children:e(ie,{className:"select",classNamePrefix:"react-select",name:"rejection_reason",options:t,value:t==null?void 0:t.find(n=>n.value===(s==null?void 0:s.reasonToReject)),onChange:n=>i("rejection_reason",n.value),children:e("option",{value:"",children:"Select a reason to reject"})})}),e("div",{className:"form-group",children:e(j,{type:"textarea",id:"rejection_message",rows:2,className:"form-control",placeholder:"More Information",name:"rejection_message",value:s==null?void 0:s.rejection_message,onChange:a})})]}),l(ne,{children:[e(k,{color:"default",onClick:u,className:"btn-lg modal-close",children:"Close"}),e(k,{color:"danger",onClick:f,className:"btn-lg",children:"Reject"})]})]})},ue=({show:r,handleClose:u,handleUpload:h,uploadData:o})=>{const t=$();return e(X,{isOpen:r,toggle:u,className:"modal-lg",children:l(Z,{children:[e(w,{closeButton:!0,children:e(ce,{children:"Upload a Graphic"})}),l(U,{children:[e("p",{children:"Upload a graphic to the Archive directory."}),e(j,{type:"file",className:"form-control",onChange:i=>{i.preventDefault();const a=new FileReader,f=i.target.files[0];a.onloadend=()=>{h({...o,upload_file:f})},a.readAsDataURL(f)}})]}),l(de,{children:[e(k,{className:"success",onClick:async i=>{i.preventDefault(),o!=null&&o.upload_file?(await t(te(o)),u()):alert("Please select a file to upload")},children:"Upload"}),e(k,{className:"secondary mx-1",onClick:u,children:"Close"})]})]})})},be=()=>{var u,h,o,t,s,d,i,a,f,n,p,x,N,v,y,C,_,m,R,g,I,P,E,F,M,T,A,G,O,q,Y,Q,z,H,V,J,K,W;const{showData:r}=B(L=>L.batchList);return l(U,{children:[l(b,{className:"p-1 pt-0",children:[l(c,{md:"1",children:[e("b",{children:"**Route:"})," "]}),e(c,{md:"9",children:((u=r==null?void 0:r.batch)==null?void 0:u.route)&&e("span",{children:l("span",{children:[(o=(h=r==null?void 0:r.batch)==null?void 0:h.route)==null?void 0:o.batch_code,"/",(s=(t=r==null?void 0:r.batch)==null?void 0:t.route)==null?void 0:s.batch_route_name," => ",r==null?void 0:r.stations]})})}),e(c,{md:"2",children:(i=(d=r==null?void 0:r.batch)==null?void 0:d.route)!=null&&i.template?l("span",{children:[(n=(f=(a=r==null?void 0:r.batch)==null?void 0:a.route)==null?void 0:f.template)==null?void 0:n.template_name," Template"]}):e("span",{children:"No Template"})})]}),l(b,{className:"p-1 pt-0",children:[e(c,{md:"1",children:e("b",{children:"Created:"})}),e(c,{md:"3",children:(p=r==null?void 0:r.batch)==null?void 0:p.creation_date}),e(c,{md:"1",children:e("b",{children:"Last Scan:"})}),e(c,{md:"3",children:(x=r==null?void 0:r.last_scan)!=null&&x.date?((N=r==null?void 0:r.last_scan)==null?void 0:N.date)+" by "+((v=r==null?void 0:r.last_scan)==null?void 0:v.username):(y=r==null?void 0:r.batch)==null?void 0:y.change_date}),e(c,{md:"1",children:e("b",{children:"Station:"})}),e(c,{md:"3",children:(C=r==null?void 0:r.batch)!=null&&C.station?((m=(_=r==null?void 0:r.batch)==null?void 0:_.station)==null?void 0:m.station_name)+" => "+((g=(R=r==null?void 0:r.batch)==null?void 0:R.station)==null?void 0:g.station_description):"Station Not Found"})]}),l(b,{className:"p-1 pt-0",children:[e(c,{md:"1",children:e("b",{children:"Export:"})}),e(c,{md:"3",children:(I=r==null?void 0:r.batch)!=null&&I.export_date?((P=r==null?void 0:r.batch)==null?void 0:P.export_count)==1?l("span",{children:["Exported ",(E=r==null?void 0:r.batch)==null?void 0:E.export_count," time"," ",(F=r==null?void 0:r.batch)==null?void 0:F.export_date]}):l("span",{children:["Exported ",(M=r==null?void 0:r.batch)==null?void 0:M.export_count," times Last export"," ",(T=r==null?void 0:r.batch)==null?void 0:T.export_date]}):"Not Exported"}),e(c,{md:"4",children:((A=r==null?void 0:r.batch)==null?void 0:A.csv_found)!=0&&"CSV File Found"})]}),l(b,{className:"p-1 pt-0",children:[e(c,{md:"1",children:e("b",{children:"Summary:"})}),(G=r==null?void 0:r.batch)!=null&&G.summary_date?e(c,{md:"6",children:l(b,{children:[l(c,{md:"6",children:["Printed ",(O=r==null?void 0:r.batch)==null?void 0:O.summary_date]}),l(c,{md:"6",children:[(q=r==null?void 0:r.batch)==null?void 0:q.summary_count," printed - last by"," ",(Q=(Y=r==null?void 0:r.batch)==null?void 0:Y.summary_user)==null?void 0:Q.username]})]})}):e(c,{md:"6",children:"Not Printed"})]}),l(b,{className:"p-1 pt-0",children:[e(c,{md:"1",children:e("b",{children:"Graphic:"})}),e(c,{md:"3",children:(z=r==null?void 0:r.batch)==null?void 0:z.graphic_found}),((H=r==null?void 0:r.batch)==null?void 0:H.to_printer)!="0"&&e(c,{md:"4",children:l(b,{children:[e(c,{md:"3",children:e("b",{children:"Printed:"})}),l(c,{md:"9",children:[(V=r==null?void 0:r.batch)==null?void 0:V.to_printer," -"," ",(J=r==null?void 0:r.batch)==null?void 0:J.to_printer_date]})]})})]}),((K=r==null?void 0:r.related)==null?void 0:K.length)>0&&l(b,{className:"p-1 pt-0",children:[e(c,{md:"1",children:e("b",{children:"Related:"})}),e(c,{md:"3",children:(W=r==null?void 0:r.related)==null?void 0:W.map(L=>l("span",{children:[L," "]}))})]})]})},me=({batchNote:r,setBatchNote:u,onClick:h})=>{var t,s;const{showData:o}=B(d=>d.batchList);return l(U,{children:[l(b,{children:[e(c,{md:"2",className:"p-1 border",children:e("b",{children:"Note"})}),e(c,{md:"1",className:"p-1 border",children:e("b",{children:"Date"})}),e(c,{md:"2",className:"p-1 border",children:e("b",{children:"User"})}),e(c,{md:"1",className:"p-1 border",children:e("b",{children:"Station"})}),e(c,{md:"2",className:"p-1 border",children:e("b",{children:"Station"})}),e(c,{md:"2",className:"p-1 border",children:e("b",{children:"Scan In"})}),e(c,{md:"2",className:"p-1 border",children:e("b",{children:"Scan Out"})})]}),l(b,{children:[e(c,{md:"6",children:(t=o==null?void 0:o.notes)==null?void 0:t.map(d=>{var i,a;return e("span",{children:l(b,{className:"p-1",children:[e(c,{md:"4",children:d==null?void 0:d.note}),e(c,{md:"2",children:he(d==null?void 0:d.created_at).format("DD MM YYYY")}),e(c,{md:"4",children:(i=d==null?void 0:d.user)==null?void 0:i.username}),e(c,{md:"2",children:(a=d==null?void 0:d.station)==null?void 0:a.station_name})]})})})}),e(c,{md:"6",children:(s=o==null?void 0:o.scans)==null?void 0:s.map(d=>{var i,a;return e("span",{children:l(b,{className:"p-1",children:[e(c,{md:"4",children:(i=d==null?void 0:d.station)==null?void 0:i.station_name}),l(c,{md:"4",children:[(a=d==null?void 0:d.in_user)==null?void 0:a.username," ",d==null?void 0:d.in_date]}),e(c,{md:"4",children:(d==null?void 0:d.out_user)&&d.out_user.username+" "+d.out_date})]})})})})]}),l(b,{children:[e(c,{md:"4",children:e(j,{type:"textarea",name:"note",id:"note",placeholder:"Enter Note",value:r,onChange:d=>{u(d.target.value)}})}),e(c,{md:"2",children:e(k,{color:"primary",onClick:h,children:"Add Note"})})]})]})},_e=({handleClose:r,setRejectData:u,handleRejectClose:h,setUploadData:o})=>{var a,f;$();const{showData:t}=B(n=>n.batchList),s=(n,p)=>{n.preventDefault(),o({item_id:p==null?void 0:p.id,batch_number:p==null?void 0:p.batch_number}),r()},d=n=>{u(n),h()},i=(n,p=`
`,x=0)=>{let N="",v="";x===1&&(N='<strong style="font-size: 110%;">',v="</strong>");let y="";const C=JSON.parse(n);if(C)for(const _ in C){let m=C[_];_!=="Confirmation_of_Order_Details"&&_!=="couponcode"&&((m==null?void 0:m.includes("$"))&&x===1&&(m=`<span style="font-size: 120%;">${m}</span>`),y+=`${_.replaceAll("_"," ")} = ${N}${m}${v}${p}`),console.log(y)}return y};return l(U,{children:[l(b,{children:[e(c,{md:"1",className:"p-1 border"}),e(c,{md:"3",className:"p-1 border",children:e("b",{children:"Order"})}),e(c,{md:"2",className:"p-1 border"}),e(c,{md:"3",className:"p-1 border",children:e("b",{children:"Product"})}),e(c,{md:"3",className:"p-1 border",children:e("b",{children:"Options"})})]}),(f=(a=t==null?void 0:t.batch)==null?void 0:a.items)==null?void 0:f.map(n=>{var p,x,N,v,y,C,_,m,R;return l("span",{children:[l(b,{className:"p-1 border",children:[e(c,{md:"1",children:(n==null?void 0:n.item_status)==="production"||(n==null?void 0:n.item_status)==="wap"||(n==null?void 0:n.item_status)==="back order"?l(k,{color:"primary",onClick:()=>d({id:t==null?void 0:t.batch_number,item_id:n==null?void 0:n.id,origin:"BD"}),children:["Reject ",(n==null?void 0:n.item_status)=="wap"?" from Wap":""]}):e("span",{children:n.item_status.charAt(0).toUpperCase()+n.item_status.slice(1)})}),l(c,{md:"3",children:["Order:"," ",e(ae,{to:`/customer-order-edit/${(p=n==null?void 0:n.order)==null?void 0:p.id}`,children:(x=n==null?void 0:n.order)==null?void 0:x.short_order}),e("br",{}),"Date : ",(N=n==null?void 0:n.order)==null?void 0:N.order_date,e("br",{}),"Store: ",(y=(v=n==null?void 0:n.order)==null?void 0:v.store)==null?void 0:y.store_name,e("br",{}),"Re Download Graphic: ",n==null?void 0:n.id,e("br",{}),((_=(C=t==null?void 0:t.batch)==null?void 0:C.station)==null?void 0:_.type)=="Q"&&l(k,{color:"primary",onClick:g=>s(g,n),children:["Upload ",n==null?void 0:n.id," Graphic"]})]}),e(c,{md:"2"}),l(c,{md:"3",children:[n==null?void 0:n.child_sku,e("br",{}),n==null?void 0:n.item_description,e("br",{}),"Item# ",n==null?void 0:n.id,e("br",{}),(n==null?void 0:n.item_quantity)===1?l("span",{children:["QTY: ",n==null?void 0:n.item_quantity]}):l("strong",{children:["QTY: ",n==null?void 0:n.item_quantity]}),e("br",{}),n.spec_sheet&&l("div",{children:[e("a",{href:`/products_specifications/${n.spec_sheet.id}`,target:"_blank",children:"Production Instruction"}),e("br",{})]}),n.supervisor_message&&l("div",{children:[n.supervisor_message,e("br",{})]}),n.tracking_number&&l("div",{style:{color:"red"},children:["TRK# ",n.tracking_number]})]}),e(c,{md:"3",children:e(j,{type:"textarea",Rows:"5",value:i(n==null?void 0:n.item_option),disabled:!0})})]}),((m=n==null?void 0:n.rejections)==null?void 0:m.length)&&((R=n==null?void 0:n.rejections)==null?void 0:R.map(g=>l(b,{className:"p-1 border",children:[e(c,{md:2}),l(c,{md:8,children:["Item ",n.id," Rejected ",g.created_at," by"," ",g.user.username,g.rejection_reason_info&&` - ${g.rejection_reason_info.rejection_message}`,"- ",g.rejection_message]})]})))]})})]})},xe=()=>{var m,R,g;const{id:r}=oe(),[u,h]=S.exports.useState(null),o=$(),{showData:t}=B(I=>I.batchList),[s,d]=S.exports.useState(!1),i=async()=>{d(!0),r&&await o(se({id:r,batchNote:u})),h(""),d(!1)};S.exports.useEffect(()=>{i()},[]);const[a,f]=S.exports.useState(!1),n=()=>f(!a),[p,x]=S.exports.useState(!1),N=()=>x(!p),[v,y]=S.exports.useState(null),[C,_]=S.exports.useState(null);return l(S.exports.Fragment,{children:[l(Z,{children:[e(w,{children:l("h4",{className:"card-title",children:["Batch: ",t==null?void 0:t.batch_number," ",((m=t==null?void 0:t.batch)==null?void 0:m.store)&&"("+((g=(R=t==null?void 0:t.batch)==null?void 0:R.store)==null?void 0:g.store_name)+")"]})}),e(be,{}),e(_e,{handleClose:n,setUploadData:_,setRejectData:y,handleRejectClose:N}),e(me,{batchNote:u,setBatchNote:h,onClick:i})]}),e(ue,{show:a,handleClose:n,uploadData:C,handleUpload:_}),e(pe,{isOpen:p,toggle:N,data:v})]})};export{xe as default};
