import{k as er,r as _,a as lr,f as l,j as n,Q as sr,V as cr,X as u,Y as s,a0 as P,da as V,G as g,I as or,dd as ar,de as hr,db as ur,df as tr,dg as pr}from"./index.a8647309.js";import{R as ir}from"./RejectModal.b5477783.js";import{S as _r}from"./ShippingPanel.41069721.js";import{a as gr}from"./App.4b41cec3.js";import"./react-select.esm.ccf2dac7.js";import"./emotion-memoize.esm.06f0e458.js";import"./plus-circle.07877bd6.js";const kr=()=>{var O,Q,j,B,$,q,L,T,A,M,R,E,Y,z;const t=gr(),x=er(),[C,f]=_.exports.useState(!0),{orderData:b,batchData:d,searchParams:h}=lr(r=>r==null?void 0:r.qualityControls),{id:w,batch:y,batch_number:S,order:o,items:c,item_options:W,dest:G,thumbs:k,label:fr,user:p}=b!=null?b:{},[X,J]=_.exports.useState(null),[I,K]=_.exports.useState(!1),N=()=>K(!I),i=async()=>{var r;if(f(!0),h){const e=await t(ar());((r=e==null?void 0:e.payload)==null?void 0:r.status)==206&&U()}else x("/quality-control");f(!1)},U=async()=>{var r;if(f(!0),h){const e=await t(hr());((r=e==null?void 0:e.payload)==null?void 0:r.status)==206&&i()}else x("/quality-control");f(!1)};_.exports.useEffect(()=>{i()},[]);const Z=async()=>{const r=await t(ur());r!=null&&r.payload&&i()},D=async(r,e)=>{r.preventDefault(),J({item_id:e,id:w,origin:"QC"}),N()},m=async()=>{const r={batch_number:y==null?void 0:y.batch_number,id:w,order_id:o==null?void 0:o.id,origin:"QC",count:c==null?void 0:c.length},e=await t(tr(r));e!=null&&e.payload&&i()};let v=0,rr="start";const nr=async(r,e)=>{r.preventDefault();const a=await pr({order_5p:e,id:d==null?void 0:d.id,batch_number:d==null?void 0:d.batch_number});a!=null&&a.payload&&i()};return l(_.exports.Fragment,{children:[n(sr,{children:l(cr,{children:[l(u,{className:"mb-1",children:[n(s,{md:"2",children:n(P,{type:"text",placeholder:"Enter Batch",value:h==null?void 0:h.batch_number,onChange:r=>{var e;return t(V({batch_number:(e=r==null?void 0:r.target)==null?void 0:e.value}))}})}),n(s,{md:"2",children:n(P,{type:"text",placeholder:"Enter Batch",value:h==null?void 0:h.user_barcode,onChange:r=>{var e;return t(V({user_barcode:(e=r==null?void 0:r.target)==null?void 0:e.value}))}})}),n(s,{md:"2",children:n(g,{color:"primary",onClick:Z,disabled:C,children:C?"Please Wait...":"Open Batch"})})]}),d?l(u,{className:"mt-2",children:[n(s,{md:"12",children:l("h3",{children:["Batch"," ",n("a",{href:`/batch-list/${d==null?void 0:d.batch_number}`,children:(O=d==null?void 0:d.batch)==null?void 0:O.batch_number})," ","-",((Q=d==null?void 0:d.batch)==null?void 0:Q.status)!="active"&&n("span",{style:{color:"red"},children:(j=d==null?void 0:d.batch)==null?void 0:j.status})]})}),l(s,{md:"6",children:[l("strong",{children:["QC in Progress by"," ",(q=($=(B=d==null?void 0:d.batch)==null?void 0:B.scanned_in)==null?void 0:$.in_user)==null?void 0:q.username]})," ","- ",(T=(L=d==null?void 0:d.batch)==null?void 0:L.scanned_in)==null?void 0:T.in_date]}),n(s,{md:"6",children:((A=d==null?void 0:d.batch)==null?void 0:A.prev_station)&&l("span",{children:[(R=(M=d==null?void 0:d.batch)==null?void 0:M.prev_station)==null?void 0:R.station_description," -"," ",(E=d==null?void 0:d.batch)==null?void 0:E.change_date]})}),n("hr",{}),(z=(Y=d==null?void 0:d.batch)==null?void 0:Y.items)==null?void 0:z.map(r=>{var F,H;let e="",a="";return(o!==(r==null?void 0:r.order_5p)||rr==="start")&&v<(r==null?void 0:r.count)?(r.count>1?(e=`rowspan=${r.count} style="vertical-align: middle"`,a=`QC ${r.count} Items`):(e="",a="QC Item"),v=0):v++,l(u,{className:"batch-row",children:[n(s,{...e&&{xs:"auto"},children:(r==null?void 0:r.order)&&l("div",{children:["Order"," ",n("a",{href:`ustomer-order-edit/${(F=r==null?void 0:r.order)==null?void 0:F.id}`,target:"_blank",rel:"noopener noreferrer",children:(H=r==null?void 0:r.order)==null?void 0:H.short_order})]})}),n(s,{children:(r==null?void 0:r.item_status)==="production"?l("div",{children:[n("br",{}),l("form",{action:url,method:"post",id:`order-form-${r.order_5p}`,children:[n("input",{type:"hidden",name:"batch_number",value:d.batch_number}),n(g,{onClick:dr=>nr(dr,r==null?void 0:r.order_5p),children:a})]})]}):r.item_status==="wap"?n("div",{children:l("strong",{children:["WAP Bin ",r.wap_item.bin.name]})}):r.item_status==="shipped"?n("div",{children:"Shipped"}):l("div",{children:[n("br",{}),r.item_status]})}),n(s,{children:(d==null?void 0:d.thumb)&&n("img",{src:d==null?void 0:d.thumb[0],height:"100"})}),n(s,{children:n("a",{href:r==null?void 0:r.item_url,target:"_blank",rel:"noopener noreferrer",children:n("img",{src:r==null?void 0:r.item_thumb,height:"100"})})}),n(s,{children:l("div",{children:[r==null?void 0:r.child_sku,n("br",{}),r==null?void 0:r.item_description,n("br",{}),(r==null?void 0:r.item_quantity)>1&&l("strong",{style:{fontSize:"125%"},children:["QTY: ",r==null?void 0:r.item_quantity]})]})}),n(s,{children:n("div",{dangerouslySetInnerHTML:{__html:d==null?void 0:d.options[r==null?void 0:r.id]}})})]},r.order_5p)})]}):l(or,{children:[l(u,{className:"d-flex justify-content-between mb-2",children:[n(s,{md:"6",children:l("h2",{children:["Order:"," ",n("b",{children:n("a",{href:`/customer-order-edit/${o==null?void 0:o.id}`,target:"_blank",children:o==null?void 0:o.short_order})})]})}),n(s,{md:"6",className:"d-flex justify-content-end",children:l("h2",{children:["Batch:"," ",n("b",{children:n("a",{href:`/batch-list/${S}`,target:"_blank",children:S})})]})})]}),c==null?void 0:c.map((r,e)=>l(u,{className:"border rounded mb-2 p-2",children:[n(s,{md:"8",children:n("h4",{children:n("b",{children:n("a",{href:r==null?void 0:r.item_url,target:"_blank",children:r==null?void 0:r.item_description})})})}),n(s,{md:"2",className:"d-flex justify-content-center mb-1",children:n(g,{color:"primary",className:"mr-1",onClick:a=>D(a,r==null?void 0:r.id),children:"Reject Item"})}),n(s,{md:"2",className:"d-flex justify-content-center mb-1",children:n(g,{color:"primary",className:"mr-1",children:"Set first-class"})}),n("hr",{}),n(s,{md:"3",children:n("a",{href:r==null?void 0:r.item_url,target:"_blank",children:n("img",{src:r==null?void 0:r.item_thumb,height:"250",width:"250"})})}),l(s,{md:"6",children:[r==null?void 0:r.child_sku,n("br",{}),"Item: ",r==null?void 0:r.id,n("br",{}),(r==null?void 0:r.item_quantity)>1&&l("strong",{style:"font-size: 125%;",children:["QTY: ",r==null?void 0:r.item_quantity]}),n("br",{}),n("div",{className:"mx-2",children:n("div",{dangerouslySetInnerHTML:{__html:W[r==null?void 0:r.id]}})})]}),n(s,{md:"3",children:k[r==null?void 0:r.id]&&n("img",{src:k[r==null?void 0:r.id][0],width:"250",height:"250"})})]})),G=="ship"?l(u,{children:[n(s,{sm:"1"}),n(s,{sm:"8",children:n(_r,{data:b,origin:"QC"})})]}):l(u,{children:[n(s,{md:"8"}),n(s,{md:"4",children:n(g,{color:"primary",className:"mr-1",onClick:m,children:(c==null?void 0:c.length)>1?(c==null?void 0:c.length)+" Lines Approved by "+(p==null?void 0:p.username):"Item Approved by "+(p==null?void 0:p.username)})})]})]})]})}),n(ir,{isOpen:I,toggle:N,data:X})]})};export{kr as default};
