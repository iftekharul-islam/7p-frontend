import{a as ye,r as D,ds as be,dt as Ne,du as xe,dv as ue,dw as Se,j as e,f as c,Q as P,S as pe,V as A,X as b,Y as l,a0 as E,G as R,L as F,I as ge,dx as Ce,dy as Oe,dz as Ye,dA as _e}from"./index.3c92940a.js";/* empty css                  */import{a as $e}from"./App.1e2e16c3.js";/* empty css                                  */import{h as L}from"./moment.4d75c86c.js";import{S as T}from"./react-select.esm.d0f99a9a.js";import"./emotion-memoize.esm.06f0e458.js";const Fe=()=>{var U,B,G,K,H,J,V,X,Z,ee,re,ne,se,ae,ce,oe,le,te;const p=$e(),s=ye(n=>n.rejects),[w,M]=D.exports.useState(!1),[h,fe]=D.exports.useState({});console.log("\u{1F680} ~ file: index.js:35 ~ index ~ batchData:",h);const z=(n,t)=>{fe({...h,[t]:{...h==null?void 0:h[t],...n}})},d=s==null?void 0:s.searchParams;D.exports.useEffect(()=>{p(be()),p(Ne()),p(xe())},[]),D.exports.useEffect(()=>{p(ue()),p(Se())},[d]);const I=async()=>{M(!0),await p(ue()),M(!1)},je=async()=>{var t,o,g,_;M(!0);let n="Are you sure you want to move all "+((o=Object.keys((t=s==null?void 0:s.data)==null?void 0:t.batch_array))==null?void 0:o.length)+" batches shown to the first station?";confirm(n)==!0&&await p(Ce(Object.keys((_=(g=s==null?void 0:s.data)==null?void 0:g.batch_array)!=null?_:{}))),M(!1)},W=async n=>{await p(Oe({id:n}))},ve=async n=>{await p(Ye({batch_number:n,...h==null?void 0:h[n]}))},k=n=>{p(_e(n))},me=async(n,t)=>{n.preventDefault(),await p(_e({graphic_status:t==null?void 0:t.graphic_status,reason:t==null?void 0:t.rejection_reason})),I()},Q=(n,t=`
`,o=0)=>{let g="",_="";o===1&&(g='<strong style="font-size: 110%;">',_="</strong>");let v="";const i=JSON.parse(n);if(i)for(const y in i){let f=i[y];y!=="Confirmation_of_Order_Details"&&y!=="couponcode"&&(typeof f=="string"&&(f==null?void 0:f.includes("$"))&&o===1&&(f=`<span style="font-size: 120%;">${f}</span>`),v+=`${y.replaceAll("_"," ")} = ${g}${f}${_}${t}`)}return v};return e("div",{className:"app-user-list",children:c(D.exports.Fragment,{children:[c(P,{className:"px-1",children:[e(pe,{children:e("h4",{className:"card-title",children:"Process Rejects"})}),e(A,{children:c(b,{children:[e(l,{sm:"2",children:e(E,{placeholder:"Batch Number",value:d==null?void 0:d.batch_number,onChange:n=>{var t;k({batch_number:(t=n==null?void 0:n.target)==null?void 0:t.value})}})}),e(l,{sm:"2",children:e(T,{className:"react-select",classNamePrefix:"select",options:s==null?void 0:s.sectionOptions,placeholder:"Select a Department",value:(U=s==null?void 0:s.sectionOptions)==null?void 0:U.find(n=>(n==null?void 0:n.value)==(d==null?void 0:d.section)),onChange:n=>k({section:n==null?void 0:n.value}),isClearable:!0})}),e(l,{sm:"2",children:e(T,{className:"react-select",classNamePrefix:"select",options:s==null?void 0:s.graphic_statusOptions,placeholder:"Select Status",value:(B=s==null?void 0:s.graphic_statusOptions)==null?void 0:B.find(n=>(n==null?void 0:n.value)==(d==null?void 0:d.graphic_status)),onChange:n=>k({graphic_status:n==null?void 0:n.value}),isClearable:!0})}),e(l,{sm:"3",children:e(T,{className:"react-select",classNamePrefix:"select",options:s==null?void 0:s.reasonOptions,placeholder:"Select a reason",value:(G=s==null?void 0:s.reasonOptions)==null?void 0:G.find(n=>(n==null?void 0:n.value)==(d==null?void 0:d.reason)),onChange:n=>k({reason:n==null?void 0:n.value}),isClearable:!0})}),e(l,{sm:"1",className:"d-flex align-items-start flex-column",children:e(R,{color:"primary",onClick:I,disabled:w,children:w?"Please Wait":"Filter"})}),e(l,{sm:"2",className:"d-flex align-items-start flex-column",children:e(R,{color:"primary",onClick:je,disabled:w,children:w?"Please Wait":"Send All to First Station"})})]})})]}),((H=(K=s==null?void 0:s.data)==null?void 0:K.summary)==null?void 0:H.length)>0?e("span",{children:e(P,{children:c(A,{children:[c(b,{className:"mb-1",children:[e(l,{sm:"6",children:"Type"}),e(l,{sm:"5",children:"Reason"}),e(l,{sm:"1",children:"Count"})]}),(V=(J=s==null?void 0:s.data)==null?void 0:J.summary)==null?void 0:V.map((n,t)=>{var o,g,_,v;return c(b,{className:"mb-1",children:[e(l,{sm:"6",children:(g=(o=s==null?void 0:s.graphic_statusOptions)==null?void 0:o.find(i=>(i==null?void 0:i.value)==(n==null?void 0:n.graphic_status)))==null?void 0:g.label}),e(l,{sm:"5",children:(v=(_=s==null?void 0:s.reasonOptions)==null?void 0:_.find(i=>(i==null?void 0:i.value)==(n==null?void 0:n.rejection_reason)))==null?void 0:v.label}),e(l,{sm:"1",children:e(F,{onClick:i=>me(i,n),children:n==null?void 0:n.count})})]},t)}),c(b,{className:"mb-1",children:[e(l,{sm:"8"}),e(l,{sm:"3",children:"Total"}),e(l,{sm:"1",children:(Z=(X=s==null?void 0:s.data)==null?void 0:X.summary)==null?void 0:Z.reduce((n,t)=>n+(t.count||0),0)})]})]})})}):((ne=Object.keys((re=(ee=s==null?void 0:s.data)==null?void 0:ee.batch_array)!=null?re:{}))==null?void 0:ne.length)>0?c(P,{children:[e(pe,{children:c("h4",{children:[(se=s==null?void 0:s.data)==null?void 0:se.total_items," found in"," ",(oe=Object.keys((ce=(ae=s==null?void 0:s.data)==null?void 0:ae.batch_array)!=null?ce:{}))==null?void 0:oe.length," Batch/es"]})}),e(A,{children:(te=Object.keys((le=s==null?void 0:s.data)==null?void 0:le.batch_array))==null?void 0:te.map((n,t)=>{var g,_,v,i,y,f,de,ie;const o=(g=s==null?void 0:s.data)==null?void 0:g.batch_array[n];return e("span",{children:c(b,{className:"mb-1 border rounded",children:[c(l,{sm:"2",children:[e("strong",{className:"m-1",children:e(F,{to:`/batch-list/${n}`,children:n})}),c("div",{children:[e(T,{className:"react-select m-1",classNamePrefix:"select",placeholder:"Send Batch to",options:s==null?void 0:s.destinationOptions,value:(_=s==null?void 0:s.destinationOptions)==null?void 0:_.find(r=>(r==null?void 0:r.value)==(d==null?void 0:d.station_change)),onChange:r=>z({station_change:r==null?void 0:r.value},n)}),c(R,{color:"primary",className:"m-1",onClick:r=>{r.preventDefault(),ve(n)},children:["Update Batch ",n]})]})]}),c(l,{sm:"10",children:[typeof(o==null?void 0:o.items)=="array"&&((v=o==null?void 0:o.items)==null?void 0:v.length)>0&&((i=o==null?void 0:o.items)==null?void 0:i.map((r,q)=>{var a,N,x,S,C,O,Y,$;return c(b,{className:"border rounded",children:[c(l,{sm:"2",children:[e("div",{children:e(F,{to:`/customer-order-edit/${(a=r==null?void 0:r.order)==null?void 0:a.id}`,children:(N=r==null?void 0:r.order)==null?void 0:N.short_order})}),e("div",{children:L((x=r==null?void 0:r.order)==null?void 0:x.order_date).format("DD MMM YYYY")}),c("div",{children:["Item: ",r==null?void 0:r.id]}),(r==null?void 0:r.item_quantity)>1&&c("strong",{style:{fontSize:"125%"},children:["QTY: ",r.item_quantity]}),e("br",{}),((S=r==null?void 0:r.rejections)==null?void 0:S.length)>1&&c(ge,{children:[e("br",{}),c("strong",{style:{color:"red"},children:["Rejected ",(C=r==null?void 0:r.rejections)==null?void 0:C.length," Times"]}),e("br",{})]}),(r==null?void 0:r.rejection)&&e(R,{color:"primary",className:"m-1",onClick:j=>{var u;j.preventDefault(),W((u=r==null?void 0:r.rejection)==null?void 0:u.id)},children:"Reprint Label"}),((O=o==null?void 0:o.items)==null?void 0:O.length)>1&&e("a",{href:`/rejections/split?item_id=${r.id}&batch_number=${r.batch_number}`,className:"btn btn-xs",children:"New Batch"})]}),e(l,{sm:"2",children:e("a",{href:r==null?void 0:r.item_url,target:"_blank",children:e("img",{src:r==null?void 0:r.item_thumb,height:90,width:90})})}),e(l,{sm:"4",children:c("div",{children:[e("div",{children:r.item_description}),c("p",{children:["SKU: ",r.child_sku]}),r.rejection?c("div",{children:[c("strong",{children:[r.rejection.graphic_status,":"]}),r.rejection.rejection_reason_info&&e("span",{children:r.rejection.rejection_reason_info.rejection_message}),(($=(Y=r==null?void 0:r.rejection)==null?void 0:Y.rejection_message)==null?void 0:$.length)>0&&c("div",{children:[e("strong",{children:"Note:"})," ",r.rejection.rejection_message]}),c("div",{children:[e("strong",{children:"Rejected:"})," ",L(r.rejection.created_at).format("DD MMM YYYY"),r.rejection.from_station&&c("span",{children:[" ","from"," ",r.rejection.from_station.station_name]}),r.rejection.user&&c("span",{children:[" ","by ",r.rejection.user.username]})]}),r.rejection.supervisor_message&&c("div",{children:[e("strong",{children:"Supervisor:"})," ",r.rejection.supervisor_message,e("br",{})]}),e(E,{type:"text",name:`supervisor_message[${r.rejection.id}]`,className:"supervisor_message form-control",onChange:j=>{var u,m;j.preventDefault(),z({supervisor_message:{...(u=h==null?void 0:h[n])==null?void 0:u.supervisor_message,[r.rejection.id]:(m=j==null?void 0:j.target)==null?void 0:m.value}},n)},style:{minWidth:"200px"},placeholder:"Enter a message"})]}):e("p",{children:"- Reject information not found -"})]})}),e(l,{sm:"4",children:Q(r==null?void 0:r.item_option)})]},q)})),typeof(o==null?void 0:o.items)=="object"&&((f=Object.keys((y=o==null?void 0:o.items)!=null?y:{}))==null?void 0:f.length)>0&&((ie=Object.keys((de=o==null?void 0:o.items)!=null?de:{}))==null?void 0:ie.map((r,q)=>{var N,x,S,C,O,Y,$,j;const a=o==null?void 0:o.items[r];return c(b,{className:"border rounded",children:[c(l,{sm:"2",children:[e("div",{children:e(F,{to:`/customer-order-edit/${(N=a==null?void 0:a.order)==null?void 0:N.id}`,children:(x=a==null?void 0:a.order)==null?void 0:x.short_order})}),e("div",{children:L((S=a==null?void 0:a.order)==null?void 0:S.order_date).format("DD MMM YYYY")}),c("div",{children:["Item: ",a==null?void 0:a.id]}),(a==null?void 0:a.item_quantity)>1&&c("strong",{style:{fontSize:"125%"},children:["QTY: ",a.item_quantity]}),e("br",{}),((C=a==null?void 0:a.rejections)==null?void 0:C.length)>1&&c(ge,{children:[e("br",{}),c("strong",{style:{color:"red"},children:["Rejected ",(O=a==null?void 0:a.rejections)==null?void 0:O.length," ","Times"]}),e("br",{})]}),(a==null?void 0:a.rejection)&&e(R,{color:"primary",className:"m-1",onClick:u=>{var m;u.preventDefault(),W((m=a==null?void 0:a.rejection)==null?void 0:m.id)},children:"Reprint Label"}),((Y=o==null?void 0:o.items)==null?void 0:Y.length)>1&&e("a",{href:`/rejections/split?item_id=${a.id}&batch_number=${a.batch_number}`,className:"btn btn-xs",children:"New Batch"})]}),e(l,{sm:"2",children:e("a",{href:a==null?void 0:a.item_url,target:"_blank",children:e("img",{src:a==null?void 0:a.item_thumb,height:200,width:150})})}),e(l,{sm:"4",children:c("div",{children:[e("div",{children:a.item_description}),c("p",{children:["SKU: ",a.child_sku]}),a.rejection?c("div",{children:[c("strong",{children:[a.rejection.graphic_status,":"]}),a.rejection.rejection_reason_info&&e("span",{children:a.rejection.rejection_reason_info.rejection_message}),((j=($=a==null?void 0:a.rejection)==null?void 0:$.rejection_message)==null?void 0:j.length)>0&&c("div",{children:[e("strong",{children:"Note:"})," ",a.rejection.rejection_message]}),c("div",{children:[e("strong",{children:"Rejected:"})," ",L(a.rejection.created_at).format("DD MMM YYYY"),a.rejection.from_station&&c("span",{children:[" ","from"," ",a.rejection.from_station.station_name]}),a.rejection.user&&c("span",{children:[" ","by ",a.rejection.user.username]})]}),a.rejection.supervisor_message&&c("div",{children:[e("strong",{children:"Supervisor:"})," ",a.rejection.supervisor_message,e("br",{})]}),e(E,{type:"text",name:`supervisor_message[${a.rejection.id}]`,className:"supervisor_message form-control",onChange:u=>{var m,he;u.preventDefault(),z({supervisor_message:{...(m=h==null?void 0:h[n])==null?void 0:m.supervisor_message,[a.rejection.id]:(he=u==null?void 0:u.target)==null?void 0:he.value}},n)},style:{minWidth:"200px"},placeholder:"Enter a message"})]}):e("p",{children:"- Reject information not found -"})]})}),e(l,{sm:"4",children:Q(a==null?void 0:a.item_option)})]},q)}))]})]})})})})]}):e(P,{children:e(A,{children:e("h4",{className:"d-flex align-items-center justify-content-center",children:"No Rejects Found"})})})]})})};export{Fe as default};
