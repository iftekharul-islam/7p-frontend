import{k as en,a as j,r as R,f as r,X as v,j as l,Y as s,L as w,a0 as m,G as g,Z as H,cE as ln,a5 as rn,cF as B,cG as sn,cH as dn,cI as on,Q as P,S as K,V as W,br as X,cJ as tn,cK as cn}from"./index.5c94aa8f.js";/* empty css                  */import{a as q}from"./App.98c84a7f.js";import{h as nn}from"./moment.4d75c86c.js";import{F as Z}from"./index.3ddf40d7.js";import{S as $}from"./react-select.esm.a71beee1.js";import"./emotion-memoize.esm.06f0e458.js";const an=(N,p)=>{var C,E;const S=q();en();const{data:i,printerOptions:y,searchParams:_}=j(n=>n.printSublimations);R.exports.useEffect(()=>{if(_!=null&&_.set_printer){const n=o==null?void 0:o.map(a=>({...a,printer:_==null?void 0:_.set_printer}));F(n)}},[_==null?void 0:_.set_printer]);const[o,F]=R.exports.useState([]);R.exports.useEffect(()=>{var n,a;((n=i==null?void 0:i.batches)==null?void 0:n.length)>0&&F((a=i==null?void 0:i.batches)==null?void 0:a.map(t=>({batch_number:t==null?void 0:t.batch_number})))},[i==null?void 0:i.batches]);const O=(n,a,t)=>{const u=o==null?void 0:o.find(h=>(h==null?void 0:h.batch_number)==n),M=o==null?void 0:o.filter(h=>(h==null?void 0:h.batch_number)!=n);F([...M,{...u,[a]:t}])},x=async n=>{O(n,"loader",!0);const a=o==null?void 0:o.find(u=>(u==null?void 0:u.batch_number)==n),t=await S(ln(a));t!=null&&t.payload&&window.open(t==null?void 0:t.payload,"_blank"),O(n,"loader",!1)};return r("span",{children:[r(v,{children:[r("h5",{children:[(C=i==null?void 0:i.batches)==null?void 0:C.length," batches found"]}),l("hr",{})]}),(E=i==null?void 0:i.batches)==null?void 0:E.map((n,a)=>{var t,u,M,h,D,A,U,I,L,b;return l("span",{children:r(v,{children:[r(s,{sm:"3",children:[l(w,{to:`/batch-list/${n==null?void 0:n.batch_number}`,children:r("strong",{children:[n==null?void 0:n.batch_number,"-"]})}),((t=n==null?void 0:n.items)==null?void 0:t.length)>1&&r("span",{children:[(u=n==null?void 0:n.items)==null?void 0:u.length," Items-"]}),(n==null?void 0:n.store_id)&&l("strong",{className:"text-danger",children:(D=(h=(M=i==null?void 0:i.stores)==null?void 0:M.find(e=>(e==null?void 0:e.value)==(n==null?void 0:n.store_id)))==null?void 0:h.label)!=null?D:null}),l("div",{children:n.route.csv_extension.toLowerCase().includes("soft")?r("div",{className:"button-box print-group",children:[r(s,{lg:"3",children:[l(m,{type:"hidden",name:"batch_number",value:n.batch_number}),l(m,{type:"hidden",name:"printer",value:"SOFT-1"}),l(g,{id:`move_${n.batch_number}`,className:"btn btn-xs btn-primary",onClick:()=>x(n.batch_number),children:"SOFT-1"})]}),r(s,{lg:"3",children:[l(m,{type:"hidden",name:"batch_number",value:n.batch_number}),l(m,{type:"hidden",name:"printer",value:"SOFT-2"}),l(g,{id:`move_${n.batch_number}`,className:"btn btn-xs btn-info",onClick:()=>x(n.batch_number),children:"SOFT-2"})]}),l(s,{lg:"3",children:r(H,{id:`move_form_${n.batch_number}${Math.floor(Math.random()*90)+10}`,children:[l(m,{type:"hidden",name:"batch_number",value:n.batch_number}),l(m,{type:"hidden",name:"printer",value:"SOFT-3"}),l(g,{id:`move_${n.batch_number}`,className:"btn btn-xs btn-primary",onClick:()=>x(n.batch_number),children:"SOFT-3"})]})}),l(s,{lg:"3",children:r(H,{id:`move_form_${n.batch_number}${Math.floor(Math.random()*90)+10}`,children:[l(m,{type:"hidden",name:"batch_number",value:n.batch_number}),l(m,{type:"hidden",name:"printer",value:"EPSON-5"}),l(g,{id:`move_${n.batch_number}`,className:"btn btn-xs btn-warning",onClick:()=>x(n.batch_number),children:"EPSON-5"})]})})]}):n.route.csv_extension.toLowerCase().includes("hard")?r("div",{className:"button-box print-group",children:[l(s,{lg:"4",children:r(H,{id:`move_form_${n.batch_number}${Math.floor(Math.random()*90)+10}`,children:[l(m,{type:"hidden",name:"batch_number",value:n.batch_number}),l(m,{type:"hidden",name:"printer",value:"HARD-1"}),l(g,{id:`move_${n.batch_number}`,className:"btn btn-xs btn-danger",onClick:()=>x(n.batch_number),children:"Send to HARD-1"})]})}),l(s,{lg:"4",children:r(H,{id:`move_form_${n.batch_number}${Math.floor(Math.random()*90)+10}`,children:[l(m,{type:"hidden",name:"batch_number",value:n.batch_number}),l(m,{type:"hidden",name:"printer",value:"HARD-2"}),l(g,{id:`move_${n.batch_number}`,className:"btn btn-xs btn-success",onClick:()=>x(n.batch_number),children:"Send to HARD-2"})]})}),l(s,{lg:"4",children:r(H,{id:`move_form_${n.batch_number}${Math.floor(Math.random()*90)+10}`,children:[l(m,{type:"hidden",name:"batch_number",value:n.batch_number}),l(m,{type:"hidden",name:"printer",value:"HARD-3"}),l(g,{id:`move_${n.batch_number}`,className:"btn btn-xs btn-danger",onClick:()=>x(n.batch_number),children:"Send to HARD-3"})]})})]}):l("div",{className:"print-group",children:r(s,{xs:"12",children:[l($,{className:"react-select",classNamePrefix:"select",options:y,value:y==null?void 0:y.find(e=>{var d;return(e==null?void 0:e.value)==((d=o==null?void 0:o.find(f=>(f==null?void 0:f.batch_number)==(n==null?void 0:n.batch_number)))==null?void 0:d.printer)}),onChange:e=>{O(n==null?void 0:n.batch_number,"printer",e==null?void 0:e.value)},placeholder:"Select Printer"}),l(g,{color:"primary",onClick:()=>x(n.batch_number),children:(A=o==null?void 0:o.find(e=>(e==null?void 0:e.batch_number)==(n==null?void 0:n.batch_number)))!=null&&A.loader?"Loading":"Send"})]})})})]}),l(s,{sm:"1",children:l("a",{href:`/batch-list/${n==null?void 0:n.batch_number}`,children:l("img",{src:(U=n==null?void 0:n.items[0])==null?void 0:U.item_thumb,alt:"print",width:"50px",height:"50px"})})}),r(s,{sm:"3",children:[(n==null?void 0:n.type)==="P"&&l("div",{children:l("strong",{style:{color:"red"},children:"IN PRODUCTION:"})}),(n==null?void 0:n.type)==="Q"&&l("div",{children:l("strong",{style:{color:"red"},children:"IN QC:"})}),n!=null&&n.production_station?r("div",{children:["Give to: ",(I=n==null?void 0:n.production_station)==null?void 0:I.station_description]}):r("div",{children:["PRODUCTION STATION NOT FOUND: ",n==null?void 0:n.production_station_id]}),(n==null?void 0:n.status)!=="active"&&r("div",{children:["Batch Status:"," ",l("strong",{style:{color:"red"},children:n==null?void 0:n.status})]}),l("br",{}),"First Order Date:"," ",nn(n==null?void 0:n.min_order_date).format("DD-MM-YYYY")]}),r(s,{sm:"1",children:["Graphic",l("br",{}),"QTY: ",(L=n==null?void 0:n.items[0])==null?void 0:L.item_quantity]}),l(s,{sm:"1",children:((n==null?void 0:n.graphic_found)=="Found"||(n==null?void 0:n.graphic_found)=="Unknown")&&l("a",{href:"batches/view_graphic?batch_number=%s",target:"_blank",children:"View Graphics"})}),r(s,{sm:"2",children:[r("div",{className:"d-flex align-items-center",children:[l("span",{children:"Scale: "}),l(m,{onChange:e=>{var d;return O(n==null?void 0:n.batch_number,"scale",(d=e==null?void 0:e.target)==null?void 0:d.value)}}),"%"]}),r("div",{children:["pdf"," ",l(m,{type:"checkbox",onChange:e=>{var d;return O(n==null?void 0:n.batch_number,"pdf",(d=e==null?void 0:e.target)==null?void 0:d.checked)}})]})]}),r(s,{sm:"1",children:[l("div",{children:"Rejects"}),(b=n==null?void 0:n.items)==null?void 0:b.map((e,d)=>{var f;e!=null&&e.rejections&&((f=e==null?void 0:e.rejections)==null||f.map((c,G)=>{var Q,Y;return r(v,{children:[l(s,{sm:"3"}),r(s,{sm:"9",children:["Item ",e==null?void 0:e.id," Rejected ",c==null?void 0:c.created_at,"by ",(Q=c==null?void 0:c.user)==null?void 0:Q.username,(c==null?void 0:c.rejection_reason_info)&&"-"+((Y=c==null?void 0:c.rejection_reason_info)==null?void 0:Y.rejection_message),"- ",c==null?void 0:c.rejection_message]})]},G)}))})]}),l("hr",{})]},a)})})]})},mn=()=>{var D,A,U,I,L,b;const N=q(),{data:p,queues:S,searchParams:i,printerOptions:y,typeOption:_,stationsOptions:o,storeOptions:F}=j(e=>e.printSublimations),[O,x]=rn(),C=O.get("select_batch"),[E,n]=R.exports.useState(!1),a=e=>{N(B(e))};R.exports.useEffect(async()=>{t(),await N(B({select_batch:C}))},[C]);const t=async()=>{n(!0),await N(sn({select_batch:C!=null?C:null})),n(!1)},u=async()=>{await N(tn())},M=()=>{N(cn())},h=async e=>{await N(B({production_station_id:[e]})),t()};return R.exports.useEffect(()=>{t(),N(dn()),N(on()),u()},[]),r(P,{children:[l(K,{children:l("h4",{children:"Send Graphics to Printer"})}),r(W,{children:[r(v,{className:"mb-1",children:[l(s,{md:"7"}),l(s,{md:"3",children:l($,{className:"react-select",classNamePrefix:"select",options:y,value:y.find(e=>e.value===(i==null?void 0:i.printer)),onChange:e=>{a({printer:e==null?void 0:e.value})}})}),l(s,{md:"2",children:l(g,{color:"primary",onClick:M,children:"Print All"})})]}),r(P,{className:"border rounded",children:[r(v,{className:"m-1",children:[l(s,{md:"1",children:l(m,{type:"text",placeholder:"Batch Number",value:i==null?void 0:i.select_batch,onChange:e=>{a({...i,select_batch:e.target.value})}})}),l(s,{md:"1",children:l($,{className:"react-select",classNamePrefix:"select",placeholder:"Type",options:_,value:_.find(e=>e.value===(i==null?void 0:i.type)),onChange:e=>{a({type:e==null?void 0:e.value})}})}),l(s,{md:"3",children:l($,{className:"react-select",classNamePrefix:"select",placeholder:"Select Section",isMulti:!0,options:o,value:o.filter(e=>{var d;return(d=i==null?void 0:i.production_station_id)==null?void 0:d.includes(e.value)}),onChange:e=>{a({...i,production_station_id:e==null?void 0:e.map(d=>d.value)})}})}),l(s,{md:"3",children:l($,{className:"react-select",classNamePrefix:"select",placeholder:"Select Store",isMulti:!0,options:F,value:F.filter(e=>{var d;return(d=i==null?void 0:i.store_id)==null?void 0:d.includes(e.value)}),onChange:e=>{a({...i,store_id:e==null?void 0:e.map(d=>d.value)})}})}),l(s,{md:"2",children:l(Z,{className:"form-control",placeholder:"From",value:(D=i==null?void 0:i.from_date)!=null?D:null,options:{dateFormat:"d-m-Y"},onChange:e=>a({from_date:e[0]})})}),l(s,{md:"2",children:l(Z,{className:"form-control",placeholder:"To",value:(A=i==null?void 0:i.to_date)!=null?A:null,options:{dateFormat:"d-m-Y"},onChange:e=>a({to_date:e[0]})})})]}),r(v,{className:"m-1 mt-0",children:[l(s,{md:"10",children:l($,{className:"react-select",classNamePrefix:"select",placeholder:"Mass set a printer",options:y,value:y.find(e=>e.value===(i==null?void 0:i.set_printer)),onChange:e=>{a({set_printer:e==null?void 0:e.value})}})}),l(s,{md:"2",children:l(g,{color:"primary",onClick:t,disabled:E,children:E?r("span",{className:"d-flex justify-content-center",children:[l(X,{size:"sm"}),"Wait..."]}):"Show"})})]})]}),l(P,{children:E?r("span",{className:"d-flex justify-content-center align-items-center",children:[l("span",{className:"mx-1",children:l(X,{size:"sm"})}),"Data Loading..."]}):r(v,{children:[l(s,{md:"10",children:((U=p==null?void 0:p.batches)==null?void 0:U.length)>0?l(an,{loading:E,setLoading:n}):((I=p==null?void 0:p.summary)==null?void 0:I.length)>0?r("span",{children:[r(v,{children:[l(s,{md:"6",className:"d-flex justify-content-start",children:l("b",{children:"Production Station"})}),l(s,{md:"3",className:"d-flex justify-content-center",children:l("b",{children:"First order"})}),l(s,{md:"3",className:"d-flex justify-content-end",children:l("b",{children:"Batches"})})]}),(L=p==null?void 0:p.summary)==null?void 0:L.map((e,d)=>{var f;return r("span",{children:[l("hr",{}),r(v,{children:[l(s,{md:"6",className:"d-flex justify-content-start",children:(f=e==null?void 0:e.production_station)==null?void 0:f.station_description}),l(s,{md:"3",className:"d-flex justify-content-center",children:nn(e==null?void 0:e.date).format("YYYY-MM-DD")}),l(s,{md:"3",className:"d-flex justify-content-end",children:l(w,{onClick:c=>{c.preventDefault(),h(e==null?void 0:e.production_station_id)},children:e==null?void 0:e.count})})]})]},d)}),l("hr",{}),r(v,{children:[l(s,{md:"6"}),l(s,{md:"3",className:"d-flex justify-content-end",children:l("b",{children:"Totol"})}),l(s,{md:"3",className:"d-flex justify-content-end",children:l("b",{children:(b=p==null?void 0:p.summary)==null?void 0:b.reduce((e,d)=>e+parseInt(d==null?void 0:d.count),0)})})]})]}):l("span",{className:"d-flex justify-content-center align-items-center",children:"Nothing Found"})}),l(s,{md:"2",children:S?Array.isArray(S)?S==null?void 0:S.map((e,d)=>{var f,c,G,Q,Y,z,V,J;return r(P,{className:"mb-1",children:[l(K,{children:l("h5",{children:d.replace("_"," ")+" "+(e==null?void 0:e.TOTAL)})}),r(W,{children:[l("b",{children:"STAGED XML"}),((f=e==null?void 0:e.STAGED_XML)==null?void 0:f.length)>0?(c=e==null?void 0:e.STAGED_XML)==null?void 0:c.map((T,k)=>r("div",{children:[T," ",l("br",{})]},k)):r("div",{children:["Nothing",l("br",{})]}),l("b",{children:"HOT FOLDER"}),((G=e==null?void 0:e.HOT_FOLDER)==null?void 0:G.length)>0?(Q=e==null?void 0:e.HOT_FOLDER)==null?void 0:Q.map((T,k)=>r("div",{children:[T," ",l("br",{})]},k)):r("div",{children:["Nothing",l("br",{})]}),l("b",{children:"RIP_QUEUE"}),((Y=e==null?void 0:e.RIP_QUEUE)==null?void 0:Y.length)>0?(z=e==null?void 0:e.RIP_QUEUE)==null?void 0:z.map((T,k)=>r("div",{children:[T," ",l("br",{})]},k)):r("div",{children:["Nothing",l("br",{})]}),l("b",{children:"PRINT_QUEUE"}),((V=e==null?void 0:e.PRINT_QUEUE)==null?void 0:V.length)>0?(J=e==null?void 0:e.PRINT_QUEUE)==null?void 0:J.map((T,k)=>r("div",{children:[T," ",l("br",{})]},k)):r("div",{children:["Nothing",l("br",{})]})]})]},mn)}):l("h5",{children:S}):r("span",{className:"d-flex justify-content-center align-items-center",children:[l(X,{size:"sm",className:"mx-1"}),"QUEUE is loading..."]})})]})})]})]})};export{mn as default};
