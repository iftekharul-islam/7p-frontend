import{j as r,az as D,f as c,Q as W,S as X,T as w,V as B,a0 as O,aA as ee,G as $,a as L,X as p,Y as n,L as re,aB as de,r as j,aC as ne,aD as ce}from"./index.3c92940a.js";import{R as le}from"./RejectModal.9de85a21.js";import{h as te}from"./moment.4d75c86c.js";import{a as Z}from"./App.1e2e16c3.js";import"./react-select.esm.d0f99a9a.js";import"./emotion-memoize.esm.06f0e458.js";const ae=({show:e,handleClose:u,handleUpload:f,uploadData:a,FileUpload:t})=>r(D,{isOpen:e,toggle:u,className:"modal-lg",children:c(W,{children:[r(X,{closeButton:!0,children:r(w,{children:"Upload a Graphic"})}),c(B,{children:[r("p",{children:"Upload a graphic to the Archive directory."}),r(O,{type:"file",className:"form-control",onChange:o=>{o.preventDefault();const s=new FileReader,g=o.target.files[0];s.onloadend=()=>{f({...a,upload_file:g})},s.readAsDataURL(g)}})]}),c(ee,{children:[r($,{className:"success",onClick:async o=>{o.preventDefault(),a!=null&&a.upload_file?(await t(a),u()):alert("Please select a file to upload")},children:"Upload"}),r($,{className:"secondary mx-1",onClick:u,children:"Close"})]})]})}),oe=()=>{var u,f,a,t,C,l,o,s,g,d,i,m,x,N,y,S,_,h,k,b,U,v,R,T,A,I,P,Y,E,G,M,q,z,Q,V,H,J,K;const{showData:e}=L(F=>F.batchList);return c(B,{children:[c(p,{className:"p-1 pt-0",children:[c(n,{md:"1",children:[r("b",{children:"**Route:"})," "]}),r(n,{md:"9",children:((u=e==null?void 0:e.batch)==null?void 0:u.route)&&r("span",{children:c("span",{children:[(a=(f=e==null?void 0:e.batch)==null?void 0:f.route)==null?void 0:a.batch_code,"/",(C=(t=e==null?void 0:e.batch)==null?void 0:t.route)==null?void 0:C.batch_route_name," => ",e==null?void 0:e.stations]})})}),r(n,{md:"2",children:(o=(l=e==null?void 0:e.batch)==null?void 0:l.route)!=null&&o.template?c("span",{children:[(d=(g=(s=e==null?void 0:e.batch)==null?void 0:s.route)==null?void 0:g.template)==null?void 0:d.template_name," Template"]}):r("span",{children:"No Template"})})]}),c(p,{className:"p-1 pt-0",children:[r(n,{md:"1",children:r("b",{children:"Created:"})}),r(n,{md:"3",children:(i=e==null?void 0:e.batch)==null?void 0:i.creation_date}),r(n,{md:"1",children:r("b",{children:"Last Scan:"})}),r(n,{md:"3",children:(m=e==null?void 0:e.last_scan)!=null&&m.date?((x=e==null?void 0:e.last_scan)==null?void 0:x.date)+" by "+((N=e==null?void 0:e.last_scan)==null?void 0:N.username):(y=e==null?void 0:e.batch)==null?void 0:y.change_date}),r(n,{md:"1",children:r("b",{children:"Station:"})}),r(n,{md:"3",children:(S=e==null?void 0:e.batch)!=null&&S.station?((h=(_=e==null?void 0:e.batch)==null?void 0:_.station)==null?void 0:h.station_name)+" => "+((b=(k=e==null?void 0:e.batch)==null?void 0:k.station)==null?void 0:b.station_description):"Station Not Found"})]}),c(p,{className:"p-1 pt-0",children:[r(n,{md:"1",children:r("b",{children:"Export:"})}),r(n,{md:"3",children:(U=e==null?void 0:e.batch)!=null&&U.export_date?((v=e==null?void 0:e.batch)==null?void 0:v.export_count)==1?c("span",{children:["Exported ",(R=e==null?void 0:e.batch)==null?void 0:R.export_count," time"," ",(T=e==null?void 0:e.batch)==null?void 0:T.export_date]}):c("span",{children:["Exported ",(A=e==null?void 0:e.batch)==null?void 0:A.export_count," times Last export"," ",(I=e==null?void 0:e.batch)==null?void 0:I.export_date]}):"Not Exported"}),r(n,{md:"4",children:((P=e==null?void 0:e.batch)==null?void 0:P.csv_found)!=0&&"CSV File Found"})]}),c(p,{className:"p-1 pt-0",children:[r(n,{md:"1",children:r("b",{children:"Summary:"})}),(Y=e==null?void 0:e.batch)!=null&&Y.summary_date?r(n,{md:"6",children:c(p,{children:[c(n,{md:"6",children:["Printed ",(E=e==null?void 0:e.batch)==null?void 0:E.summary_date]}),c(n,{md:"6",children:[(G=e==null?void 0:e.batch)==null?void 0:G.summary_count," printed - last by"," ",(q=(M=e==null?void 0:e.batch)==null?void 0:M.summary_user)==null?void 0:q.username]})]})}):r(n,{md:"6",children:"Not Printed"})]}),c(p,{className:"p-1 pt-0",children:[r(n,{md:"1",children:r("b",{children:"Graphic:"})}),r(n,{md:"3",children:(z=e==null?void 0:e.batch)==null?void 0:z.graphic_found}),((Q=e==null?void 0:e.batch)==null?void 0:Q.to_printer)!="0"&&r(n,{md:"4",children:c(p,{children:[r(n,{md:"3",children:r("b",{children:"Printed:"})}),c(n,{md:"9",children:[(V=e==null?void 0:e.batch)==null?void 0:V.to_printer," -"," ",(H=e==null?void 0:e.batch)==null?void 0:H.to_printer_date]})]})})]}),((J=e==null?void 0:e.related)==null?void 0:J.length)>0&&c(p,{className:"p-1 pt-0",children:[r(n,{md:"1",children:r("b",{children:"Related:"})}),r(n,{md:"3",children:(K=e==null?void 0:e.related)==null?void 0:K.map(F=>c("span",{children:[F," "]}))})]})]})},se=({batchNote:e,setBatchNote:u,onClick:f})=>{var t,C;const{showData:a}=L(l=>l.batchList);return c(B,{children:[c(p,{children:[r(n,{md:"2",className:"p-1 border",children:r("b",{children:"Note"})}),r(n,{md:"1",className:"p-1 border",children:r("b",{children:"Date"})}),r(n,{md:"2",className:"p-1 border",children:r("b",{children:"User"})}),r(n,{md:"1",className:"p-1 border",children:r("b",{children:"Station"})}),r(n,{md:"2",className:"p-1 border",children:r("b",{children:"Station"})}),r(n,{md:"2",className:"p-1 border",children:r("b",{children:"Scan In"})}),r(n,{md:"2",className:"p-1 border",children:r("b",{children:"Scan Out"})})]}),c(p,{children:[r(n,{md:"6",children:(t=a==null?void 0:a.notes)==null?void 0:t.map(l=>{var o,s;return r("span",{children:c(p,{className:"p-1",children:[r(n,{md:"4",children:l==null?void 0:l.note}),r(n,{md:"2",children:te(l==null?void 0:l.created_at).format("DD MM YYYY")}),r(n,{md:"4",children:(o=l==null?void 0:l.user)==null?void 0:o.username}),r(n,{md:"2",children:(s=l==null?void 0:l.station)==null?void 0:s.station_name})]})})})}),r(n,{md:"6",children:(C=a==null?void 0:a.scans)==null?void 0:C.map(l=>{var o,s;return r("span",{children:c(p,{className:"p-1",children:[r(n,{md:"4",children:(o=l==null?void 0:l.station)==null?void 0:o.station_name}),c(n,{md:"4",children:[(s=l==null?void 0:l.in_user)==null?void 0:s.username," ",l==null?void 0:l.in_date]}),r(n,{md:"4",children:(l==null?void 0:l.out_user)&&l.out_user.username+" "+l.out_date})]})})})})]}),c(p,{children:[r(n,{md:"4",children:r(O,{type:"textarea",name:"note",id:"note",placeholder:"Enter Note",value:e,onChange:l=>{u(l.target.value)}})}),r(n,{md:"2",children:r($,{color:"primary",onClick:f,children:"Add Note"})})]})]})},ie=({handleClose:e,setRejectData:u,handleRejectClose:f,setUploadData:a})=>{var s,g;Z();const{showData:t}=L(d=>d.batchList),C=(d,i)=>{d.preventDefault(),a({item_id:i==null?void 0:i.id,batch_number:i==null?void 0:i.batch_number}),e()},l=d=>{u(d),f()},o=(d,i=`
`,m=0)=>{let x="",N="";m===1&&(x='<strong style="font-size: 110%;">',N="</strong>");let y="";const S=JSON.parse(d);if(S)for(const _ in S){let h=S[_];_!=="Confirmation_of_Order_Details"&&_!=="couponcode"&&(typeof h===String&&(h==null?void 0:h.includes("$"))&&m===1&&(h=`<span style="font-size: 120%;">${h}</span>`),y+=`${_.replaceAll("_"," ")} = ${x}${h}${N}${i}`)}return y};return c(B,{children:[c(p,{children:[r(n,{md:"1",className:"p-1 border"}),r(n,{md:"3",className:"p-1 border",children:r("b",{children:"Order"})}),r(n,{md:"2",className:"p-1 border"}),r(n,{md:"3",className:"p-1 border",children:r("b",{children:"Product"})}),r(n,{md:"3",className:"p-1 border",children:r("b",{children:"Options"})})]}),(g=(s=t==null?void 0:t.batch)==null?void 0:s.items)==null?void 0:g.map(d=>{var i,m,x,N,y,S,_,h,k;return c("span",{children:[c(p,{className:"p-1 border",children:[r(n,{md:"1",children:(d==null?void 0:d.item_status)==="production"||(d==null?void 0:d.item_status)==="wap"||(d==null?void 0:d.item_status)==="back order"?c($,{color:"primary",onClick:()=>l({id:t==null?void 0:t.batch_number,item_id:d==null?void 0:d.id,origin:"BD"}),children:["Reject ",(d==null?void 0:d.item_status)=="wap"?" from Wap":""]}):r("span",{children:d.item_status.charAt(0).toUpperCase()+d.item_status.slice(1)})}),c(n,{md:"3",children:["Order:"," ",r(re,{to:`/customer-order-edit/${(i=d==null?void 0:d.order)==null?void 0:i.id}`,children:(m=d==null?void 0:d.order)==null?void 0:m.short_order}),r("br",{}),"Date : ",(x=d==null?void 0:d.order)==null?void 0:x.order_date,r("br",{}),"Store: ",(y=(N=d==null?void 0:d.order)==null?void 0:N.store)==null?void 0:y.store_name,r("br",{}),"Re Download Graphic: ",d==null?void 0:d.id,r("br",{}),((_=(S=t==null?void 0:t.batch)==null?void 0:S.station)==null?void 0:_.type)=="G"&&c($,{color:"primary",onClick:b=>C(b,d),children:["Upload ",d==null?void 0:d.id," Graphic"]})]}),c(n,{md:"2",children:[(d==null?void 0:d.sure3d_thumb)&&r("img",{src:d==null?void 0:d.sure3d_thumb[0],width:"150",height:"150"}),r("a",{href:d==null?void 0:d.item_url,target:"_blank",children:r("img",{src:d==null?void 0:d.item_thumb,width:"150",height:"150"})})]}),c(n,{md:"3",children:[d==null?void 0:d.child_sku,r("br",{}),d==null?void 0:d.item_description,r("br",{}),"Item# ",d==null?void 0:d.id,r("br",{}),(d==null?void 0:d.item_quantity)===1?c("span",{children:["QTY: ",d==null?void 0:d.item_quantity]}):c("strong",{children:["QTY: ",d==null?void 0:d.item_quantity]}),r("br",{}),d.spec_sheet&&c("div",{children:[r("a",{href:`/products_specifications/${d.spec_sheet.id}`,target:"_blank",children:"Production Instruction"}),r("br",{})]}),d.supervisor_message&&c("div",{children:[d.supervisor_message,r("br",{})]}),d.tracking_number&&c("div",{style:{color:"red"},children:["TRK# ",d.tracking_number]})]}),r(n,{md:"3",children:r(O,{type:"textarea",Rows:"5",value:o(d==null?void 0:d.item_option),disabled:!0})})]}),((h=d==null?void 0:d.rejections)==null?void 0:h.length)&&((k=d==null?void 0:d.rejections)==null?void 0:k.map(b=>c(p,{className:"p-1 border",children:[r(n,{md:2}),c(n,{md:8,children:["Item ",d.id," Rejected ",b.created_at," by"," ",b.user.username,b.rejection_reason_info&&` - ${b.rejection_reason_info.rejection_message}`,"- ",b.rejection_message]})]})))]})})]})},ge=()=>{var b,U,v;const{id:e}=de(),[u,f]=j.exports.useState(null),a=Z(),{showData:t}=L(R=>R.batchList),[C,l]=j.exports.useState(!1),o=async()=>{l(!0),e&&await a(ne({id:e,batchNote:u})),f(""),l(!1)};j.exports.useEffect(()=>{o()},[]);const[s,g]=j.exports.useState(!1),d=()=>g(!s),i=async R=>{await a(ce(R)),o(),g(!s)},[m,x]=j.exports.useState(!1),N=()=>x(!m),[y,S]=j.exports.useState({origin:"BD",title:"Batch view"}),[_,h]=j.exports.useState(null),k=R=>{S({...y,...R})};return c(j.exports.Fragment,{children:[c(W,{children:[r(X,{children:c("h4",{className:"card-title",children:["Batch: ",t==null?void 0:t.batch_number," ",((b=t==null?void 0:t.batch)==null?void 0:b.store)&&"("+((v=(U=t==null?void 0:t.batch)==null?void 0:U.store)==null?void 0:v.store_name)+")"]})}),r(oe,{}),r(ie,{handleClose:d,setUploadData:h,setRejectData:k,handleRejectClose:N}),r(se,{batchNote:u,setBatchNote:f,onClick:o})]}),r(ae,{show:s,handleClose:d,uploadData:_,handleUpload:h,FileUpload:i}),r(le,{isOpen:m,toggle:N,data:y})]})};export{ge as default};
