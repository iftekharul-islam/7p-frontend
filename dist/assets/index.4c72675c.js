import{a as Z,r as P,f as l,X as v,j as n,Y as d,L as J,a0 as t,G as u,Z as Q,cy as w,cz as q,cA as nn,Q as Y,S as z,V as X,bn as H,cB as V,cC as en,cD as ln,cE as rn}from"./index.a9bf0764.js";/* empty css                  */import{a as K}from"./App.b82a553b.js";import{h as j}from"./moment.4d75c86c.js";import{F as W}from"./index.abfd74ba.js";import{S as $}from"./react-select.esm.751c38ed.js";import"./emotion-memoize.esm.06f0e458.js";const sn=(N,m)=>{var E,f;const y=K(),{data:r,printerOptions:T}=Z(e=>e.printSublimations),[_,F]=P.exports.useState([]);P.exports.useEffect(()=>{var e,g;((e=r==null?void 0:r.batches)==null?void 0:e.length)>0&&F((g=r==null?void 0:r.batches)==null?void 0:g.map(c=>({batch_number:c==null?void 0:c.batch_number})))},[r==null?void 0:r.batches]);const D=(e,g,c)=>{const M=_==null?void 0:_.find(p=>(p==null?void 0:p.batch_number)==e),x=_==null?void 0:_.filter(p=>(p==null?void 0:p.batch_number)!=e);F([...x,{...M,[g]:c}])},a=e=>{const g=_==null?void 0:_.find(c=>(c==null?void 0:c.batch_number)==e);g?y(w(g)):alert("Please select Printer")};return l("span",{children:[l(v,{children:[l("h5",{children:[(E=r==null?void 0:r.batches)==null?void 0:E.length," batches found"]}),n("hr",{})]}),(f=r==null?void 0:r.batches)==null?void 0:f.map((e,g)=>{var c,M,x,p,R,k,A,U,i;return n("span",{children:l(v,{className:(e==null?void 0:e.to_printer_date)!=null&&"bg-info",children:[l(d,{sm:"3",children:[n(J,{to:`/batch-list/${e==null?void 0:e.batch_number}`,children:l("strong",{children:[e==null?void 0:e.batch_number,"-"]})}),((c=e==null?void 0:e.items)==null?void 0:c.length)>1&&l("span",{children:[(M=e==null?void 0:e.items)==null?void 0:M.length," Items-"]}),(e==null?void 0:e.store_id)&&n("strong",{className:"text-danger",children:(R=(p=(x=r==null?void 0:r.stores)==null?void 0:x.find(s=>(s==null?void 0:s.value)==(e==null?void 0:e.store_id)))==null?void 0:p.label)!=null?R:null}),n("div",{children:e.route.csv_extension.toLowerCase().includes("soft")?l("div",{className:"button-box print-group",children:[l(d,{lg:"3",children:[n(t,{type:"hidden",name:"batch_number",value:e.batch_number}),n(t,{type:"hidden",name:"printer",value:"SOFT-1"}),n(u,{id:`move_${e.batch_number}`,className:"btn btn-xs btn-primary",onClick:()=>a(e.batch_number),children:"SOFT-1"})]}),l(d,{lg:"3",children:[n(t,{type:"hidden",name:"batch_number",value:e.batch_number}),n(t,{type:"hidden",name:"printer",value:"SOFT-2"}),n(u,{id:`move_${e.batch_number}`,className:"btn btn-xs btn-info",onClick:()=>a(e.batch_number),children:"SOFT-2"})]}),n(d,{lg:"3",children:l(Q,{id:`move_form_${e.batch_number}${Math.floor(Math.random()*90)+10}`,children:[n(t,{type:"hidden",name:"batch_number",value:e.batch_number}),n(t,{type:"hidden",name:"printer",value:"SOFT-3"}),n(u,{id:`move_${e.batch_number}`,className:"btn btn-xs btn-primary",onClick:()=>a(e.batch_number),children:"SOFT-3"})]})}),n(d,{lg:"3",children:l(Q,{id:`move_form_${e.batch_number}${Math.floor(Math.random()*90)+10}`,children:[n(t,{type:"hidden",name:"batch_number",value:e.batch_number}),n(t,{type:"hidden",name:"printer",value:"EPSON-5"}),n(u,{id:`move_${e.batch_number}`,className:"btn btn-xs btn-warning",onClick:()=>a(e.batch_number),children:"EPSON-5"})]})})]}):e.route.csv_extension.toLowerCase().includes("hard")?l("div",{className:"button-box print-group",children:[n(d,{lg:"4",children:l(Q,{id:`move_form_${e.batch_number}${Math.floor(Math.random()*90)+10}`,children:[n(t,{type:"hidden",name:"batch_number",value:e.batch_number}),n(t,{type:"hidden",name:"printer",value:"HARD-1"}),n(u,{id:`move_${e.batch_number}`,className:"btn btn-xs btn-danger",onClick:()=>a(e.batch_number),children:"Send to HARD-1"})]})}),n(d,{lg:"4",children:l(Q,{id:`move_form_${e.batch_number}${Math.floor(Math.random()*90)+10}`,children:[n(t,{type:"hidden",name:"batch_number",value:e.batch_number}),n(t,{type:"hidden",name:"printer",value:"HARD-2"}),n(u,{id:`move_${e.batch_number}`,className:"btn btn-xs btn-success",onClick:()=>a(e.batch_number),children:"Send to HARD-2"})]})}),n(d,{lg:"4",children:l(Q,{id:`move_form_${e.batch_number}${Math.floor(Math.random()*90)+10}`,children:[n(t,{type:"hidden",name:"batch_number",value:e.batch_number}),n(t,{type:"hidden",name:"printer",value:"HARD-3"}),n(u,{id:`move_${e.batch_number}`,className:"btn btn-xs btn-danger",onClick:()=>a(e.batch_number),children:"Send to HARD-3"})]})})]}):n("div",{className:"print-group",children:l(d,{xs:"12",children:[n($,{className:"react-select",classNamePrefix:"select",options:T,onChange:s=>{D(e==null?void 0:e.batch_number,"printer",s==null?void 0:s.value)},placeholder:"Select Printer"}),n(u,{color:"primary",onClick:()=>a(e.batch_number),children:"Send"})]})})})]}),n(d,{sm:"1",children:n("a",{href:`/batch-list/${e==null?void 0:e.batch_number}`,children:n("img",{src:(k=e==null?void 0:e.items[0])==null?void 0:k.item_thumb,alt:"print",width:"50px",height:"50px"})})}),l(d,{sm:"3",children:[(e==null?void 0:e.type)==="P"&&n("div",{children:n("strong",{style:{color:"red"},children:"IN PRODUCTION:"})}),(e==null?void 0:e.type)==="Q"&&n("div",{children:n("strong",{style:{color:"red"},children:"IN QC:"})}),e!=null&&e.production_station?l("div",{children:["Give to: ",(A=e==null?void 0:e.production_station)==null?void 0:A.station_description]}):l("div",{children:["PRODUCTION STATION NOT FOUND: ",e==null?void 0:e.production_station_id]}),(e==null?void 0:e.status)!=="active"&&l("div",{children:["Batch Status:"," ",n("strong",{style:{color:"red"},children:e==null?void 0:e.status})]}),n("br",{}),"First Order Date:"," ",j(e==null?void 0:e.min_order_date).format("DD-MM-YYYY")]}),l(d,{sm:"1",children:["Graphic",n("br",{}),"QTY: ",(U=e==null?void 0:e.items[0])==null?void 0:U.item_quantity]}),n(d,{sm:"1",children:((e==null?void 0:e.graphic_found)=="Found"||(e==null?void 0:e.graphic_found)=="Unknown")&&n("a",{href:"batches/view_graphic?batch_number=%s",target:"_blank",children:"View Graphics"})}),l(d,{sm:"2",children:[l("div",{className:"d-flex align-items-center",children:[n("span",{children:"Scale: "}),n(t,{onChange:s=>{var h;return D(e==null?void 0:e.batch_number,"scale",(h=s==null?void 0:s.target)==null?void 0:h.value)}}),"%"]}),l("div",{children:["pdf"," ",n(t,{type:"checkbox",onChange:s=>{var h;return D(e==null?void 0:e.batch_number,"pdf",(h=s==null?void 0:s.target)==null?void 0:h.checked)}})]})]}),l(d,{sm:"1",children:[n("div",{children:"Rejects"}),(i=e==null?void 0:e.items)==null?void 0:i.map((s,h)=>{var S;s!=null&&s.rejections&&((S=s==null?void 0:s.rejections)==null||S.map((o,b)=>{var I,L;return l(v,{children:[n(d,{sm:"3"}),l(d,{sm:"9",children:["Item ",s==null?void 0:s.id," Rejected ",o==null?void 0:o.created_at,"by ",(I=o==null?void 0:o.user)==null?void 0:I.username,(o==null?void 0:o.rejection_reason_info)&&"-"+((L=o==null?void 0:o.rejection_reason_info)==null?void 0:L.rejection_message),"- ",o==null?void 0:o.rejection_message]})]},b)}))})]}),n("hr",{})]},g)})})]})},dn=()=>{var x,p,R,k,A,U;const N=K(),{data:m,queues:y,searchParams:r,printerOptions:T,typeOption:_,stationsOptions:F,storeOptions:D}=Z(i=>i.printSublimations),[a,E]=P.exports.useState(!1),f=i=>{N(V(i))},e=async()=>{E(!0),await N(en()),E(!1)},g=async()=>{await N(ln())},c=()=>{N(rn())},M=async i=>{await N(V({production_station_id:[i]})),e()};return P.exports.useEffect(()=>{e(),N(q()),N(nn()),g()},[]),l(Y,{children:[n(z,{children:n("h4",{children:"Send Graphics to Printer"})}),l(X,{children:[l(v,{className:"mb-1",children:[n(d,{md:"7"}),n(d,{md:"3",children:n($,{className:"react-select",classNamePrefix:"select",options:T,value:T.find(i=>i.value===(r==null?void 0:r.printer)),onChange:i=>{f({printer:i==null?void 0:i.value})}})}),n(d,{md:"2",children:n(u,{color:"primary",onClick:c,children:"Print All"})})]}),l(Y,{className:"border rounded",children:[l(v,{className:"m-1",children:[n(d,{md:"1",children:n(t,{type:"text",placeholder:"Batch Number",value:r==null?void 0:r.select_batch,onChange:i=>{f({...r,select_batch:i.target.value})}})}),n(d,{md:"1",children:n($,{className:"react-select",classNamePrefix:"select",placeholder:"Type",options:_,value:_.find(i=>i.value===(r==null?void 0:r.type)),onChange:i=>{f({type:i==null?void 0:i.value})}})}),n(d,{md:"3",children:n($,{className:"react-select",classNamePrefix:"select",placeholder:"Select Section",isMulti:!0,options:F,value:F.filter(i=>{var s;return(s=r==null?void 0:r.production_station_id)==null?void 0:s.includes(i.value)}),onChange:i=>{f({...r,production_station_id:i==null?void 0:i.map(s=>s.value)})}})}),n(d,{md:"3",children:n($,{className:"react-select",classNamePrefix:"select",placeholder:"Select Store",isMulti:!0,options:D,value:D.filter(i=>{var s;return(s=r==null?void 0:r.store_id)==null?void 0:s.includes(i.value)}),onChange:i=>{f({...r,store_id:i==null?void 0:i.map(s=>s.value)})}})}),n(d,{md:"2",children:n(W,{className:"form-control",placeholder:"From",value:(x=r==null?void 0:r.from_date)!=null?x:null,options:{dateFormat:"d-m-Y"},onChange:i=>f({from_date:i[0]})})}),n(d,{md:"2",children:n(W,{className:"form-control",placeholder:"To",value:(p=r==null?void 0:r.to_date)!=null?p:null,options:{dateFormat:"d-m-Y"},onChange:i=>f({to_date:i[0]})})})]}),l(v,{className:"m-1 mt-0",children:[n(d,{md:"10",children:n($,{className:"react-select",classNamePrefix:"select",placeholder:"Mass set a printer",options:T,value:T.find(i=>i.value===(r==null?void 0:r.set_printer)),onChange:i=>{f({set_printer:i==null?void 0:i.value})}})}),n(d,{md:"2",children:n(u,{color:"primary",onClick:e,disabled:a,children:a?l("span",{className:"d-flex justify-content-center",children:[n(H,{size:"sm"}),"Wait..."]}):"Show"})})]})]}),n(Y,{children:a?l("span",{className:"d-flex justify-content-center align-items-center",children:[n("span",{className:"mx-1",children:n(H,{size:"sm"})}),"Data Loading..."]}):l(v,{children:[n(d,{md:"10",children:((R=m==null?void 0:m.batches)==null?void 0:R.length)>0?n(sn,{loading:a,setLoading:E}):((k=m==null?void 0:m.summary)==null?void 0:k.length)>0?l("span",{children:[l(v,{children:[n(d,{md:"6",className:"d-flex justify-content-start",children:n("b",{children:"Production Station"})}),n(d,{md:"3",className:"d-flex justify-content-center",children:n("b",{children:"First order"})}),n(d,{md:"3",className:"d-flex justify-content-end",children:n("b",{children:"Batches"})})]}),(A=m==null?void 0:m.summary)==null?void 0:A.map((i,s)=>{var h;return l("span",{children:[n("hr",{}),l(v,{children:[n(d,{md:"6",className:"d-flex justify-content-start",children:(h=i==null?void 0:i.production_station)==null?void 0:h.station_description}),n(d,{md:"3",className:"d-flex justify-content-center",children:j(i==null?void 0:i.date).format("YYYY-MM-DD")}),n(d,{md:"3",className:"d-flex justify-content-end",children:n(J,{onClick:S=>{S.preventDefault(),M(i==null?void 0:i.production_station_id)},children:i==null?void 0:i.count})})]})]},s)}),n("hr",{}),l(v,{children:[n(d,{md:"6"}),n(d,{md:"3",className:"d-flex justify-content-end",children:n("b",{children:"Totol"})}),n(d,{md:"3",className:"d-flex justify-content-end",children:n("b",{children:(U=m==null?void 0:m.summary)==null?void 0:U.reduce((i,s)=>i+parseInt(s==null?void 0:s.count),0)})})]})]}):n("span",{className:"d-flex justify-content-center align-items-center",children:"Nothing Found"})}),n(d,{md:"2",children:y?Array.isArray(y)?y==null?void 0:y.map((i,s)=>{var h,S,o,b,I,L,G,B;return l(Y,{className:"mb-1",children:[n(z,{children:n("h5",{children:s.replace("_"," ")+" "+(i==null?void 0:i.TOTAL)})}),l(X,{children:[n("b",{children:"STAGED XML"}),((h=i==null?void 0:i.STAGED_XML)==null?void 0:h.length)>0?(S=i==null?void 0:i.STAGED_XML)==null?void 0:S.map((C,O)=>l("div",{children:[C," ",n("br",{})]},O)):l("div",{children:["Nothing",n("br",{})]}),n("b",{children:"HOT FOLDER"}),((o=i==null?void 0:i.HOT_FOLDER)==null?void 0:o.length)>0?(b=i==null?void 0:i.HOT_FOLDER)==null?void 0:b.map((C,O)=>l("div",{children:[C," ",n("br",{})]},O)):l("div",{children:["Nothing",n("br",{})]}),n("b",{children:"RIP_QUEUE"}),((I=i==null?void 0:i.RIP_QUEUE)==null?void 0:I.length)>0?(L=i==null?void 0:i.RIP_QUEUE)==null?void 0:L.map((C,O)=>l("div",{children:[C," ",n("br",{})]},O)):l("div",{children:["Nothing",n("br",{})]}),n("b",{children:"PRINT_QUEUE"}),((G=i==null?void 0:i.PRINT_QUEUE)==null?void 0:G.length)>0?(B=i==null?void 0:i.PRINT_QUEUE)==null?void 0:B.map((C,O)=>l("div",{children:[C," ",n("br",{})]},O)):l("div",{children:["Nothing",n("br",{})]})]})]},dn)}):n("h5",{children:y}):l("span",{className:"d-flex justify-content-center align-items-center",children:[n(H,{size:"sm",className:"mx-1"}),"QUEUE is loading..."]})})]})})]})]})};export{dn as default};
